ù
óD:\Documentos\UMG\0 -Decimo Semestre\1. Proyecto de Graduaci√≥n II\Software\GestionInventario\GestorInventarios\CapaModeloGestorInventarios\Conexion.cs
	namespace 	'
CapaModeloGestorInventarios
 %
{		 
class

 
Conexion

 
{ 
public 
OdbcConnection 
conexion &
(& '
)' (
{ 	
OdbcConnection 
conn 
=  !
new" %
OdbcConnection& 4
(4 5
$str5 G
)G H
;H I
try 
{ 
conn 
. 
Open 
( 
) 
; 
Console 
. 
	WriteLine !
(! "
$str" +
)+ ,
;, -
} 
catch 
( 
OdbcException  
)  !
{ 
Console 
. 
	WriteLine !
(! "
$str" .
). /
;/ 0
} 
return 
conn 
; 
} 	
public 
void 
desconexion 
(  
OdbcConnection  .
conn/ 3
)3 4
{ 	
try 
{ 
conn   
.   
Close   
(   
)   
;   
Console!! 
.!! 
	WriteLine!! !
(!!! "
$str!!" 3
)!!3 4
;!!4 5
}"" 
catch## 
(## 
OdbcException##  
)##  !
{$$ 
Console%% 
.%% 
	WriteLine%% !
(%%! "
$str%%" .
)%%. /
;%%/ 0
}&& 
}'' 	
}(( 
})) “
¶D:\Documentos\UMG\0 -Decimo Semestre\1. Proyecto de Graduaci√≥n II\Software\GestionInventario\GestorInventarios\CapaModeloGestorInventarios\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str 6
)6 7
]7 8
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str 8
)8 9
]9 :
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *Øﬂ
ôD:\Documentos\UMG\0 -Decimo Semestre\1. Proyecto de Graduaci√≥n II\Software\GestionInventario\GestorInventarios\CapaModeloGestorInventarios\Sentencias.cs
	namespace

 	'
CapaModeloGestorInventarios


 %
{ 
public 

class 

Sentencias 
{ 
private 
Conexion 
cn 
= 
new !
Conexion" *
(* +
)+ ,
;, -
public 
void !
EnviarContratoDespido )
() *
DateTimePicker* 8
date9 =
,= >
TextBox? F
	textoDateG P
,P Q
CheckBoxR Z
check[ `
)` a
{ 	
String 
dt 
= 
$str 
; 
if 
( 
check 
. 
Checked 
==  
true! %
)% &
{ 
	textoDate 
. 
Text 
=  
$str! #
;# $
} 
else 
if 
( 
check 
. 
Checked "
==# %
false& +
)+ ,
{ 
dt 
= 
date 
. 
Value 
.  
ToString  (
(( )
$str) 5
)5 6
;6 7
	textoDate 
. 
Text 
=  
dt! #
;# $
} 
} 	
public 
void "
RecibirContratoDespido *
(* +
DateTimePicker+ 9
date: >
,> ?
TextBox@ G
	textoDateH Q
,Q R
CheckBoxS [
check\ a
)a b
{ 	
if 
( 
check 
. 
Checked 
==  
true! %
)% &
{   
}!! 
else"" 
if"" 
("" 
check"" 
."" 
Checked"" "
==""# %
false""& +
)""+ ,
{## 
if$$ 
($$ 
	textoDate$$ 
.$$ 
Text$$ "
!=$$# %
$str$$& (
)$$( )
{%% 
date&& 
.&& 
Value&& 
=&&  
Convert&&! (
.&&( )

ToDateTime&&) 3
(&&3 4
	textoDate&&4 =
.&&= >
Text&&> B
.&&B C
ToString&&C K
(&&K L
)&&L M
)&&M N
;&&N O
}'' 
}(( 
})) 	
public** 
void** 
bloqueareporte** "
(**" #
string**# )
tipousuario*** 5
,**5 6
Button**7 =
reporte**> E
)**E F
{++ 	
if,, 
(,, 
tipousuario,, 
==,, 
$str,, &
||,,' )
tipousuario,,* 5
==,,6 8
$str,,9 @
||,,A C
tipousuario,,D O
==,,P R
$str,,S Z
||,,[ ]
tipousuario,,^ i
==,,j l
$str,,m |
||,,} 
tipousuario
,,Ä ã
==
,,å é
$str
,,è û
||
,,ü °
tipousuario
,,¢ ≠
==
,,Æ ∞
$str
,,± ¿
)
,,¿ ¡
{-- 
reporte.. 
... 
Enabled.. 
=..  !
true.." &
;..& '
}// 
else00 
if00 
(00 
tipousuario00  
==00! #
$str00$ 0
||001 3
tipousuario004 ?
==00@ B
$str00C O
||00P R
tipousuario00S ^
==00_ a
$str00b n
)00n o
{11 
reporte22 
.22 
Enabled22 
=22  !
true22" &
;22& '
}33 
else44 
if44 
(44 
tipousuario44  
==44! #
$str44$ /
||440 2
tipousuario443 >
==44? A
$str44B M
||44N P
tipousuario44Q \
==44] _
$str44` k
)44k l
{55 
reporte66 
.66 
Enabled66 
=66  !
false66" '
;66' (
}77 
}88 	
public99 
void99 
bloqueaimagen99 !
(99! "
string99" (
tipousuario99) 4
,994 5
Button996 <
imagen99= C
)99C D
{:: 	
if;; 
(;; 
tipousuario;; 
==;; 
$str;; &
||;;' )
tipousuario;;* 5
==;;6 8
$str;;9 @
||;;A C
tipousuario;;D O
==;;P R
$str;;S Z
||;;[ ]
tipousuario;;^ i
==;;j l
$str;;m |
||;;} 
tipousuario
;;Ä ã
==
;;å é
$str
;;è û
||
;;ü °
tipousuario
;;¢ ≠
==
;;Æ ∞
$str
;;± ¿
)
;;¿ ¡
{<< 
imagen== 
.== 
Enabled== 
===  
true==! %
;==% &
}>> 
else?? 
if?? 
(?? 
tipousuario??  
==??! #
$str??$ 0
||??1 3
tipousuario??4 ?
==??@ B
$str??C O
||??P R
tipousuario??S ^
==??_ a
$str??b n
)??n o
{@@ 
imagenAA 
.AA 
EnabledAA 
=AA  
falseAA! &
;AA& '
}BB 
elseCC 
ifCC 
(CC 
tipousuarioCC  
==CC! #
$strCC$ /
||CC0 2
tipousuarioCC3 >
==CC? A
$strCCB M
||CCN P
tipousuarioCCQ \
==CC] _
$strCC` k
)CCk l
{DD 
imagenEE 
.EE 
EnabledEE 
=EE  
falseEE! &
;EE& '
}FF 
}GG 	
publicHH 
voidHH 
CambioContrasenaHH $
(HH$ %
stringHH% +
tablaHH, 1
,HH1 2
stringHH3 9

contrasenaHH: D
,HHD E
stringHHF L
idHHM O
,HHO P
stringHHQ W
usuarioHHX _
)HH_ `
{II 	
tryJJ 
{KK 
stringLL 
cadenaLL 
=LL 
$strLL  )
+LL* +
tablaLL, 1
+LL2 3
$strLL4 I
+LLJ K

contrasenaLLL V
+LLW X
$strLLY ]
+LL^ _
$strLL` n
+LLo p
idLLq s
+LLt u
$str	LLv è
+
LLê ë
usuario
LLí ô
+
LLö õ
$str
LLú †
;
LL† °
OdbcCommandMM 
consultaMM $
=MM% &
newMM' *
OdbcCommandMM+ 6
(MM6 7
cadenaMM7 =
,MM= >
cnMM? A
.MMA B
conexionMMB J
(MMJ K
)MMK L
)MML M
;MMM N
consultaNN 
.NN 
ExecuteNonQueryNN (
(NN( )
)NN) *
;NN* +

MessageBoxOO 
.OO 
ShowOO 
(OO  
$strOO  A
)OOA B
;OOB C
}PP 
catchQQ 
(QQ 
	ExceptionQQ 
exQQ 
)QQ  
{RR 

MessageBoxSS 
.SS 
ShowSS 
(SS  
$strSS  6
+SS7 8
exSS9 ;
)SS; <
;SS< =
}TT 
}UU 	
publicVV 
intVV %
idSiguienteDeNuevoIngresoVV ,
(VV, -
stringVV- 3
tablaVV4 9
,VV9 :
stringVV; A
campoBVVB H
)VVH I
{WW 	
stringXX 
ultimoEnteroXX 
=XX  !
$strXX" $
;XX$ %
intXX& )
enteroSumadoXX* 6
=XX7 8
$numXX9 :
;XX: ;
OdbcDataReaderXX< J
leerXXK O
=XXP Q
nullXXR V
;XXV W
stringYY 
sqlYY 
=YY 
$strYY #
+YY$ %
campoBYY& ,
+YY- .
$strYY/ 3
+YY4 5
$strYY6 >
+YY? @
campoBYYA G
+YYH I
$strYYJ S
+YYT U
tablaYYV [
+YY\ ]
$strYY^ j
+YYk l
campoBYYm s
+YYt u
$str	YYv Ü
;
YYÜ á
OdbcConnectionZZ 
conectZZ !
=ZZ" #
cnZZ$ &
.ZZ& '
conexionZZ' /
(ZZ/ 0
)ZZ0 1
;ZZ1 2
try[[ 
{\\ 
OdbcCommand]] 
comando]] #
=]]$ %
new]]& )
OdbcCommand]]* 5
(]]5 6
sql]]6 9
,]]9 :
conect]]; A
)]]A B
;]]B C
leer^^ 
=^^ 
comando^^ 
.^^ 
ExecuteReader^^ ,
(^^, -
)^^- .
;^^. /
while__ 
(__ 
leer__ 
.__ 
Read__  
(__  !
)__! "
)__" #
{`` 
ultimoEnteroaa  
=aa! "
leeraa# '
.aa' (
	GetStringaa( 1
(aa1 2
$numaa2 3
)aa3 4
;aa4 5
enteroSumadobb  
=bb! "
intbb# &
.bb& '
Parsebb' ,
(bb, -
ultimoEnterobb- 9
)bb9 :
+bb; <
$numbb= >
;bb> ?
}cc 
}dd 
catchee 
(ee 
OdbcExceptionee  
exee! #
)ee# $
{ff 

MessageBoxff 
.ff 
Showff 
(ff 
$strff 9
+ff: ;
exff< >
.ff> ?
Messageff? F
)ffF G
;ffG H
}ffI J
finallygg 
{hh 
cnhh 
.hh 
desconexionhh 
(hh 
conecthh #
)hh# $
;hh$ %
}hh& '
ifii 
(ii 
enteroSumadoii 
==ii 
$numii  !
)ii! "
{jj 
enteroSumadojj 
=jj 
$numjj 
;jj 
}jj  !
returnll 
enteroSumadoll 
;ll  
}mm 	
publicnn 
bytenn 
[nn 
]nn 
obtenerBytenn !
(nn! "
stringnn" (
idnn) +
)nn+ ,
{oo 	
intpp 

bufferSizepp 
=pp 
$numpp  
;pp  !
bytepp" &
[pp& '
]pp' (
bytefotopp) 1
=pp2 3
newpp4 7
bytepp8 <
[pp< =

bufferSizepp= G
]ppG H
;ppH I
byteqq 
[qq 
]qq 
binaryqq 
=qq 
nullqq  
;qq  !
tryrr 
{ss 
stringtt 
insertQuerytt "
=tt# $
$strtt% G
+ttH I
idttJ L
+ttM N
$strttO S
;ttS T
OdbcConnectionuu 
conectuu %
=uu& '
cnuu( *
.uu* +
conexionuu+ 3
(uu3 4
)uu4 5
;uu5 6
OdbcCommandvv 
commandvv #
=vv$ %
newvv& )
OdbcCommandvv* 5
(vv5 6
insertQueryvv6 A
,vvA B
conectvvC I
)vvI J
;vvJ K
commandww 
.ww 
ExecuteNonQueryww '
(ww' (
)ww( )
;ww) *
OdbcDataReaderww+ 9
	busquedacww: C
;wwC D
	busquedacxx 
=xx 
commandxx #
.xx# $
ExecuteReaderxx$ 1
(xx1 2
)xx2 3
;xx3 4
ifyy 
(yy 
!yy 
	busquedacyy 
.yy 
HasRowsyy &
)yy& '
{zz 
throw{{ 
new{{ 
	Exception{{ '
({{' (
$str{{( E
){{E F
;{{F G
}|| 
if}} 
(}} 
	busquedac}} 
.}} 
Read}} "
(}}" #
)}}# $
)}}$ %
{~~ 
binary 
= 
( 
byte "
[" #
]# $
)$ %
	busquedac% .
[. /
$str/ ;
]; <
;< =
}
ÄÄ 
cn
ÅÅ 
.
ÅÅ 
desconexion
ÅÅ 
(
ÅÅ 
conect
ÅÅ %
)
ÅÅ% &
;
ÅÅ& '
return
ÇÇ 
binary
ÇÇ 
;
ÇÇ 
}
ÉÉ 
catch
ÑÑ 
(
ÑÑ 
	Exception
ÑÑ 
ex
ÑÑ 
)
ÑÑ  
{
ÖÖ 

MessageBox
ÜÜ 
.
ÜÜ 
Show
ÜÜ 
(
ÜÜ  
$str
ÜÜ  8
+
ÜÜ9 :
ex
ÜÜ; =
)
ÜÜ= >
;
ÜÜ> ?
return
áá 
null
áá 
;
áá 
}
àà 
}
ââ 	
public
ãã 
void
ãã 
insertaNuevaFoto
ãã $
(
ãã$ %
string
ãã% +
id
ãã, .
,
ãã. /
byte
ãã0 4
[
ãã4 5
]
ãã5 6
foto
ãã7 ;
)
ãã; <
{
åå 	
try
çç 
{
éé 
string
èè 
insertQuery
èè "
=
èè# $
$str
èè% A
+
èèB C
id
èèD F
+
èèG H
$str
èèI P
;
èèP Q
OdbcConnection
êê 
conect
êê %
=
êê& '
cn
êê( *
.
êê* +
conexion
êê+ 3
(
êê3 4
)
êê4 5
;
êê5 6
OdbcCommand
ëë 
command
ëë #
=
ëë$ %
new
ëë& )
OdbcCommand
ëë* 5
(
ëë5 6
insertQuery
ëë6 A
,
ëëA B
conect
ëëC I
)
ëëI J
;
ëëJ K
OdbcParameter
íí 
prm
íí !
=
íí" #
new
íí$ '
OdbcParameter
íí( 5
(
íí5 6
$str
íí6 <
,
íí< =
OdbcType
íí> F
.
ííF G
Binary
ííG M
,
ííM N
foto
ííO S
.
ííS T
Length
ííT Z
,
ííZ [ 
ParameterDirection
íí\ n
.
íín o
Input
íío t
,
íít u
false
íív {
,
íí{ |
$num
íí} ~
,
íí~ 
$numííÄ Å
,ííÅ Ç
nullííÉ á
,ííá à
DataRowVersionííâ ó
.ííó ò
Currentííò ü
,ííü †
fotoíí° •
)íí• ¶
;íí¶ ß
command
ìì 
.
ìì 

Parameters
ìì "
.
ìì" #
Add
ìì# &
(
ìì& '
prm
ìì' *
)
ìì* +
;
ìì+ ,
if
ïï 
(
ïï 
command
ïï 
.
ïï 
ExecuteNonQuery
ïï +
(
ïï+ ,
)
ïï, -
==
ïï. 0
$num
ïï1 2
)
ïï2 3
{
ññ 

MessageBox
óó 
.
óó 
Show
óó #
(
óó# $
$str
óó$ 2
,
óó2 3
$str
óó4 ;
)
óó; <
;
óó< =
}
òò 
cn
ôô 
.
ôô 
desconexion
ôô 
(
ôô 
conect
ôô %
)
ôô% &
;
ôô& '
}
öö 
catch
õõ 
(
õõ 
	Exception
õõ 
ex
õõ 
)
õõ  
{
úú 

MessageBox
ùù 
.
ùù 
Show
ùù 
(
ùù  
$str
ùù  9
+
ùù: ;
ex
ùù< >
)
ùù> ?
;
ùù? @
}
ûû 
}
üü 	
public
°° 
void
°° 
insertaFoto
°° 
(
°°  
string
°°  &
id
°°' )
,
°°) *
byte
°°+ /
[
°°/ 0
]
°°0 1
foto
°°2 6
)
°°6 7
{
¢¢ 	
try
££ 
{
§§ 
string
•• 
insertQuery
•• "
=
••# $
$str
••% P
+
••Q R
id
••S U
+
••V W
$str
••X \
;
••\ ]
OdbcConnection
¶¶ 
conect
¶¶ %
=
¶¶& '
cn
¶¶( *
.
¶¶* +
conexion
¶¶+ 3
(
¶¶3 4
)
¶¶4 5
;
¶¶5 6
OdbcCommand
ßß 
command
ßß #
=
ßß$ %
new
ßß& )
OdbcCommand
ßß* 5
(
ßß5 6
insertQuery
ßß6 A
,
ßßA B
conect
ßßC I
)
ßßI J
;
ßßJ K
OdbcParameter
®® 
prm
®® !
=
®®" #
new
®®$ '
OdbcParameter
®®( 5
(
®®5 6
$str
®®6 <
,
®®< =
OdbcType
®®> F
.
®®F G
Binary
®®G M
,
®®M N
foto
®®O S
.
®®S T
Length
®®T Z
,
®®Z [ 
ParameterDirection
®®\ n
.
®®n o
Input
®®o t
,
®®t u
false
®®v {
,
®®{ |
$num
®®} ~
,
®®~ 
$num®®Ä Å
,®®Å Ç
null®®É á
,®®á à
DataRowVersion®®â ó
.®®ó ò
Current®®ò ü
,®®ü †
foto®®° •
)®®• ¶
;®®¶ ß
command
©© 
.
©© 

Parameters
©© "
.
©©" #
Add
©©# &
(
©©& '
prm
©©' *
)
©©* +
;
©©+ ,
if
´´ 
(
´´ 
command
´´ 
.
´´ 
ExecuteNonQuery
´´ +
(
´´+ ,
)
´´, -
==
´´. 0
$num
´´1 2
)
´´2 3
{
¨¨ 

MessageBox
≠≠ 
.
≠≠ 
Show
≠≠ #
(
≠≠# $
$str
≠≠$ 2
,
≠≠2 3
$str
≠≠4 ;
)
≠≠; <
;
≠≠< =
}
ÆÆ 
cn
ØØ 
.
ØØ 
desconexion
ØØ 
(
ØØ 
conect
ØØ %
)
ØØ% &
;
ØØ& '
}
∞∞ 
catch
±± 
(
±± 
	Exception
±± 
ex
±± 
)
±±  
{
≤≤ 

MessageBox
≥≥ 
.
≥≥ 
Show
≥≥ 
(
≥≥  
$str
≥≥  9
+
≥≥: ;
ex
≥≥< >
)
≥≥> ?
;
≥≥? @
}
¥¥ 
}
µµ 	
public
∂∂ 
void
∂∂  
bloqueaa√±adirprov
∂∂ %
(
∂∂% &
string
∂∂& ,
tipousuario
∂∂- 8
,
∂∂8 9
Button
∂∂: @

anadirprov
∂∂A K
)
∂∂K L
{
∑∑ 	
if
∏∏ 
(
∏∏ 
tipousuario
∏∏ 
==
∏∏ 
$str
∏∏ &
||
∏∏' )
tipousuario
∏∏* 5
==
∏∏6 8
$str
∏∏9 @
||
∏∏A C
tipousuario
∏∏D O
==
∏∏P R
$str
∏∏S Z
||
∏∏[ ]
tipousuario
∏∏^ i
==
∏∏j l
$str
∏∏m |
||
∏∏} 
tipousuario∏∏Ä ã
==∏∏å é
$str∏∏è û
||∏∏ü °
tipousuario∏∏¢ ≠
==∏∏Æ ∞
$str∏∏± ¿
)∏∏¿ ¡
{
ππ 

anadirprov
∫∫ 
.
∫∫ 
Enabled
∫∫ "
=
∫∫# $
true
∫∫% )
;
∫∫) *
}
ªª 
else
ºº 
if
ºº 
(
ºº 
tipousuario
ºº  
==
ºº! #
$str
ºº$ 0
||
ºº1 3
tipousuario
ºº4 ?
==
ºº@ B
$str
ººC O
||
ººP R
tipousuario
ººS ^
==
ºº_ a
$str
ººb n
)
ººn o
{
ΩΩ 

anadirprov
ææ 
.
ææ 
Enabled
ææ "
=
ææ# $
false
ææ% *
;
ææ* +
}
øø 
else
¿¿ 
if
¿¿ 
(
¿¿ 
tipousuario
¿¿  
==
¿¿! #
$str
¿¿$ /
||
¿¿0 2
tipousuario
¿¿3 >
==
¿¿? A
$str
¿¿B M
||
¿¿N P
tipousuario
¿¿Q \
==
¿¿] _
$str
¿¿` k
)
¿¿k l
{
¡¡ 

anadirprov
¬¬ 
.
¬¬ 
Enabled
¬¬ "
=
¬¬# $
false
¬¬% *
;
¬¬* +
}
√√ 
}
ƒƒ 	
public
≈≈ 
void
≈≈ 
LlenarCombo
≈≈ 
(
≈≈  
ComboBox
≈≈  (
cbx
≈≈) ,
,
≈≈, -
string
≈≈. 4
tabla
≈≈5 :
,
≈≈: ;
string
≈≈< B
campobuscado
≈≈C O
,
≈≈O P
string
≈≈Q W
catsup
≈≈X ^
)
≈≈^ _
{
∆∆ 	
string
«« 
dato
«« 
=
«« 
$str
«« 
;
«« 
try
»» 
{
…… 
cbx
   
.
   
Items
   
.
   
Clear
   
(
    
)
    !
;
  ! "
string
ÀÀ 
insertQuery
ÀÀ "
=
ÀÀ# $
$str
ÀÀ% 5
+
ÀÀ6 7
tabla
ÀÀ8 =
+
ÀÀ> ?
$str
ÀÀ@ d
+
ÀÀe f
catsup
ÀÀg m
+
ÀÀn o
$str
ÀÀp t
;
ÀÀt u
OdbcConnection
ÕÕ 
conect
ÕÕ %
=
ÕÕ& '
cn
ÕÕ( *
.
ÕÕ* +
conexion
ÕÕ+ 3
(
ÕÕ3 4
)
ÕÕ4 5
;
ÕÕ5 6
OdbcCommand
ŒŒ 
command
ŒŒ #
=
ŒŒ$ %
new
ŒŒ& )
OdbcCommand
ŒŒ* 5
(
ŒŒ5 6
insertQuery
ŒŒ6 A
,
ŒŒA B
conect
ŒŒC I
)
ŒŒI J
;
ŒŒJ K
command
œœ 
.
œœ 
ExecuteNonQuery
œœ '
(
œœ' (
)
œœ( )
;
œœ) *
OdbcDataReader
œœ+ 9
	busquedac
œœ: C
;
œœC D
	busquedac
–– 
=
–– 
command
–– #
.
––# $
ExecuteReader
––$ 1
(
––1 2
)
––2 3
;
––3 4
if
—— 
(
—— 
!
—— 
	busquedac
—— 
.
—— 
HasRows
—— &
)
——& '
{
““ 
}
‘‘ 
while
’’ 
(
’’ 
	busquedac
’’  
.
’’  !
Read
’’! %
(
’’% &
)
’’& '
)
’’' (
{
÷÷ 
dato
◊◊ 
=
◊◊ 
	busquedac
◊◊ $
[
◊◊$ %
campobuscado
◊◊% 1
]
◊◊1 2
.
◊◊2 3
ToString
◊◊3 ;
(
◊◊; <
)
◊◊< =
;
◊◊= >
cbx
ÿÿ 
.
ÿÿ 
Items
ÿÿ 
.
ÿÿ 
Add
ÿÿ !
(
ÿÿ! "
dato
ÿÿ" &
)
ÿÿ& '
;
ÿÿ' (
}
ŸŸ 
cn
⁄⁄ 
.
⁄⁄ 
desconexion
⁄⁄ 
(
⁄⁄ 
conect
⁄⁄ %
)
⁄⁄% &
;
⁄⁄& '
}
€€ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹ 
ex
‹‹ 
)
‹‹  
{
›› 
}
ﬁﬁ 
}
ﬂﬂ 	
public
‡‡ 
void
‡‡ 
LlenarCategoria
‡‡ #
(
‡‡# $
ComboBox
‡‡$ ,
cbx
‡‡- 0
,
‡‡0 1
string
‡‡2 8
tabla
‡‡9 >
,
‡‡> ?
string
‡‡@ F
campobuscado
‡‡G S
,
‡‡S T
string
‡‡U [
tipo
‡‡\ `
)
‡‡` a
{
·· 	
string
‚‚ 
dato
‚‚ 
=
‚‚ 
$str
‚‚ 
;
‚‚ 
try
„„ 
{
‰‰ 
cbx
ÂÂ 
.
ÂÂ 
Items
ÂÂ 
.
ÂÂ 
Clear
ÂÂ 
(
ÂÂ  
)
ÂÂ  !
;
ÂÂ! "
string
ÊÊ 
insertQuery
ÊÊ "
=
ÊÊ# $
$str
ÊÊ% 5
+
ÊÊ6 7
tabla
ÊÊ8 =
+
ÊÊ> ?
$str
ÊÊ@ b
+
ÊÊc d
tipo
ÊÊe i
+
ÊÊj k
$str
ÊÊl p
;
ÊÊp q
OdbcConnection
ËË 
conect
ËË %
=
ËË& '
cn
ËË( *
.
ËË* +
conexion
ËË+ 3
(
ËË3 4
)
ËË4 5
;
ËË5 6
OdbcCommand
ÈÈ 
command
ÈÈ #
=
ÈÈ$ %
new
ÈÈ& )
OdbcCommand
ÈÈ* 5
(
ÈÈ5 6
insertQuery
ÈÈ6 A
,
ÈÈA B
conect
ÈÈC I
)
ÈÈI J
;
ÈÈJ K
command
ÍÍ 
.
ÍÍ 
ExecuteNonQuery
ÍÍ '
(
ÍÍ' (
)
ÍÍ( )
;
ÍÍ) *
OdbcDataReader
ÍÍ+ 9
	busquedac
ÍÍ: C
;
ÍÍC D
	busquedac
ÎÎ 
=
ÎÎ 
command
ÎÎ #
.
ÎÎ# $
ExecuteReader
ÎÎ$ 1
(
ÎÎ1 2
)
ÎÎ2 3
;
ÎÎ3 4
if
ÏÏ 
(
ÏÏ 
!
ÏÏ 
	busquedac
ÏÏ 
.
ÏÏ 
HasRows
ÏÏ &
)
ÏÏ& '
{
ÌÌ 
}
ÔÔ 
while
 
(
 
	busquedac
  
.
  !
Read
! %
(
% &
)
& '
)
' (
{
ÒÒ 
dato
ÚÚ 
=
ÚÚ 
	busquedac
ÚÚ $
[
ÚÚ$ %
campobuscado
ÚÚ% 1
]
ÚÚ1 2
.
ÚÚ2 3
ToString
ÚÚ3 ;
(
ÚÚ; <
)
ÚÚ< =
;
ÚÚ= >
cbx
ÛÛ 
.
ÛÛ 
Items
ÛÛ 
.
ÛÛ 
Add
ÛÛ !
(
ÛÛ! "
dato
ÛÛ" &
)
ÛÛ& '
;
ÛÛ' (
}
ÙÙ 
cn
ıı 
.
ıı 
desconexion
ıı 
(
ıı 
conect
ıı %
)
ıı% &
;
ıı& '
}
ˆˆ 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜ 
ex
˜˜ 
)
˜˜  
{
¯¯ 
}
˘˘ 
}
˙˙ 	
public
˚˚ 
void
˚˚ 
IDcombo
˚˚ 
(
˚˚ 
TextBox
˚˚ #
textbox
˚˚$ +
,
˚˚+ ,
string
˚˚- 3
tabla
˚˚4 9
,
˚˚9 :
string
˚˚; A
campobuscado
˚˚B N
,
˚˚N O
string
˚˚P V
nombre
˚˚W ]
)
˚˚] ^
{
¸¸ 	
string
˝˝ 
dato
˝˝ 
=
˝˝ 
$str
˝˝ 
;
˝˝ 
try
˛˛ 
{
ˇˇ 
textbox
ÄÄ 
.
ÄÄ 
Text
ÄÄ 
=
ÄÄ 
$str
ÄÄ !
;
ÄÄ! "
string
ÅÅ 
insertQuery
ÅÅ "
=
ÅÅ# $
$str
ÅÅ% 5
+
ÅÅ6 7
tabla
ÅÅ8 =
+
ÅÅ> ?
$str
ÅÅ@ d
+
ÅÅe f
nombre
ÅÅg m
+
ÅÅn o
$str
ÅÅp t
;
ÅÅt u
OdbcConnection
ÉÉ 
conect
ÉÉ %
=
ÉÉ& '
cn
ÉÉ( *
.
ÉÉ* +
conexion
ÉÉ+ 3
(
ÉÉ3 4
)
ÉÉ4 5
;
ÉÉ5 6
OdbcCommand
ÑÑ 
command
ÑÑ #
=
ÑÑ$ %
new
ÑÑ& )
OdbcCommand
ÑÑ* 5
(
ÑÑ5 6
insertQuery
ÑÑ6 A
,
ÑÑA B
conect
ÑÑC I
)
ÑÑI J
;
ÑÑJ K
command
ÖÖ 
.
ÖÖ 
ExecuteNonQuery
ÖÖ '
(
ÖÖ' (
)
ÖÖ( )
;
ÖÖ) *
OdbcDataReader
ÖÖ+ 9
	busquedac
ÖÖ: C
;
ÖÖC D
	busquedac
ÜÜ 
=
ÜÜ 
command
ÜÜ #
.
ÜÜ# $
ExecuteReader
ÜÜ$ 1
(
ÜÜ1 2
)
ÜÜ2 3
;
ÜÜ3 4
if
áá 
(
áá 
!
áá 
	busquedac
áá 
.
áá 
HasRows
áá &
)
áá& '
{
àà 
}
ää 
while
ãã 
(
ãã 
	busquedac
ãã  
.
ãã  !
Read
ãã! %
(
ãã% &
)
ãã& '
)
ãã' (
{
åå 
dato
çç 
=
çç 
	busquedac
çç $
[
çç$ %
campobuscado
çç% 1
]
çç1 2
.
çç2 3
ToString
çç3 ;
(
çç; <
)
çç< =
;
çç= >
textbox
éé 
.
éé 
Text
éé  
=
éé! "
dato
éé# '
;
éé' (
}
èè 
cn
êê 
.
êê 
desconexion
êê 
(
êê 
conect
êê %
)
êê% &
;
êê& '
}
ëë 
catch
íí 
(
íí 
	Exception
íí 
ex
íí 
)
íí  
{
ìì 
}
îî 
}
ïï 	
public
ññ 
void
ññ 
NombreID
ññ 
(
ññ 
ComboBox
ññ %
combo
ññ& +
,
ññ+ ,
string
ññ- 3
tabla
ññ4 9
,
ññ9 :
string
ññ; A
campobuscado
ññB N
,
ññN O
string
ññP V
pkid
ññW [
)
ññ[ \
{
óó 	
string
òò 
dato
òò 
=
òò 
$str
òò 
;
òò 
try
ôô 
{
öö 
string
úú 
insertQuery
úú "
=
úú# $
$str
úú% 5
+
úú6 7
tabla
úú8 =
+
úú> ?
$str
úú@ b
+
úúc d
pkid
úúe i
+
úúj k
$str
úúl p
;
úúp q
OdbcConnection
ûû 
conect
ûû %
=
ûû& '
cn
ûû( *
.
ûû* +
conexion
ûû+ 3
(
ûû3 4
)
ûû4 5
;
ûû5 6
OdbcCommand
üü 
command
üü #
=
üü$ %
new
üü& )
OdbcCommand
üü* 5
(
üü5 6
insertQuery
üü6 A
,
üüA B
conect
üüC I
)
üüI J
;
üüJ K
command
†† 
.
†† 
ExecuteNonQuery
†† '
(
††' (
)
††( )
;
††) *
OdbcDataReader
††+ 9
	busquedac
††: C
;
††C D
	busquedac
°° 
=
°° 
command
°° #
.
°°# $
ExecuteReader
°°$ 1
(
°°1 2
)
°°2 3
;
°°3 4
if
¢¢ 
(
¢¢ 
!
¢¢ 
	busquedac
¢¢ 
.
¢¢ 
HasRows
¢¢ &
)
¢¢& '
{
££ 
}
•• 
while
¶¶ 
(
¶¶ 
	busquedac
¶¶  
.
¶¶  !
Read
¶¶! %
(
¶¶% &
)
¶¶& '
)
¶¶' (
{
ßß 
dato
®® 
=
®® 
	busquedac
®® $
[
®®$ %
campobuscado
®®% 1
]
®®1 2
.
®®2 3
ToString
®®3 ;
(
®®; <
)
®®< =
;
®®= >
combo
©© 
.
©© 
SelectedItem
©© &
=
©©' (
dato
©©) -
;
©©- .
}
™™ 
cn
´´ 
.
´´ 
desconexion
´´ 
(
´´ 
conect
´´ %
)
´´% &
;
´´& '
}
¨¨ 
catch
≠≠ 
(
≠≠ 
	Exception
≠≠ 
ex
≠≠ 
)
≠≠  
{
ÆÆ 
}
ØØ 
}
∞∞ 	
public
±± 
void
±± 
bloqueabotones
±± "
(
±±" #
string
±±# )
tipousuario
±±* 5
,
±±5 6
Button
±±7 =
btnIngresar
±±> I
,
±±I J
Button
±±K Q
	btnEditar
±±R [
,
±±[ \
Button
±±] c

btnGuardar
±±d n
,
±±n o
Button
±±p v
btnCancelar±±w Ç
,±±Ç É
Button±±Ñ ä
btnEliminar±±ã ñ
,±±ñ ó
Button±±ò û
btnImprimir±±ü ™
,±±™ ´
Button±±¨ ≤
btnActualizar±±≥ ¿
,±±¿ ¡
Button±±¬ »
btnAyuda±±… —
,±±— “
Button±±” Ÿ
btnSalir±±⁄ ‚
)±±‚ „
{
≤≤ 	
if
≥≥ 
(
≥≥ 
tipousuario
≥≥ 
==
≥≥ 
$str
≥≥ &
||
≥≥' )
tipousuario
≥≥* 5
==
≥≥6 8
$str
≥≥9 @
||
≥≥A C
tipousuario
≥≥D O
==
≥≥P R
$str
≥≥S Z
||
≥≥[ ]
tipousuario
≥≥^ i
==
≥≥j l
$str
≥≥m |
||
≥≥} 
tipousuario≥≥Ä ã
==≥≥å é
$str≥≥è û
||≥≥ü °
tipousuario≥≥¢ ≠
==≥≥Æ ∞
$str≥≥± ¿
)≥≥¿ ¡
{
¥¥ 
btnIngresar
µµ 
.
µµ 
Enabled
µµ #
=
µµ$ %
true
µµ& *
;
µµ* +
	btnEditar
∂∂ 
.
∂∂ 
Enabled
∂∂ !
=
∂∂" #
true
∂∂$ (
;
∂∂( )

btnGuardar
∑∑ 
.
∑∑ 
Enabled
∑∑ "
=
∑∑# $
true
∑∑% )
;
∑∑) *
btnCancelar
∏∏ 
.
∏∏ 
Enabled
∏∏ #
=
∏∏$ %
true
∏∏& *
;
∏∏* +
btnEliminar
ππ 
.
ππ 
Enabled
ππ #
=
ππ$ %
true
ππ& *
;
ππ* +
btnImprimir
∫∫ 
.
∫∫ 
Enabled
∫∫ #
=
∫∫$ %
true
∫∫& *
;
∫∫* +
btnActualizar
ªª 
.
ªª 
Enabled
ªª %
=
ªª& '
true
ªª( ,
;
ªª, -
btnAyuda
ºº 
.
ºº 
Enabled
ºº  
=
ºº! "
true
ºº# '
;
ºº' (
btnSalir
ΩΩ 
.
ΩΩ 
Enabled
ΩΩ  
=
ΩΩ! "
true
ΩΩ# '
;
ΩΩ' (
}
ææ 
else
øø 
if
øø 
(
øø 
tipousuario
øø  
==
øø! #
$str
øø$ 0
||
øø1 3
tipousuario
øø4 ?
==
øø@ B
$str
øøC O
||
øøP R
tipousuario
øøS ^
==
øø_ a
$str
øøb n
)
øøn o
{
¿¿ 
btnIngresar
¡¡ 
.
¡¡ 
Enabled
¡¡ #
=
¡¡$ %
false
¡¡& +
;
¡¡+ ,
	btnEditar
¬¬ 
.
¬¬ 
Enabled
¬¬ !
=
¬¬" #
false
¬¬$ )
;
¬¬) *

btnGuardar
√√ 
.
√√ 
Enabled
√√ "
=
√√# $
false
√√% *
;
√√* +
btnCancelar
ƒƒ 
.
ƒƒ 
Enabled
ƒƒ #
=
ƒƒ$ %
false
ƒƒ& +
;
ƒƒ+ ,
btnEliminar
≈≈ 
.
≈≈ 
Enabled
≈≈ #
=
≈≈$ %
false
≈≈& +
;
≈≈+ ,
btnImprimir
∆∆ 
.
∆∆ 
Enabled
∆∆ #
=
∆∆$ %
true
∆∆& *
;
∆∆* +
btnActualizar
«« 
.
«« 
Enabled
«« %
=
««& '
true
««( ,
;
««, -
btnAyuda
»» 
.
»» 
Enabled
»»  
=
»»! "
true
»»# '
;
»»' (
btnSalir
…… 
.
…… 
Enabled
……  
=
……! "
true
……# '
;
……' (
}
   
else
ÀÀ 
if
ÀÀ 
(
ÀÀ 
tipousuario
ÀÀ  
==
ÀÀ! #
$str
ÀÀ$ /
||
ÀÀ0 2
tipousuario
ÀÀ3 >
==
ÀÀ? A
$str
ÀÀB M
||
ÀÀN P
tipousuario
ÀÀQ \
==
ÀÀ] _
$str
ÀÀ` k
)
ÀÀk l
{
ÃÃ 
btnIngresar
ÕÕ 
.
ÕÕ 
Enabled
ÕÕ #
=
ÕÕ$ %
false
ÕÕ& +
;
ÕÕ+ ,
	btnEditar
ŒŒ 
.
ŒŒ 
Enabled
ŒŒ !
=
ŒŒ" #
false
ŒŒ$ )
;
ŒŒ) *

btnGuardar
œœ 
.
œœ 
Enabled
œœ "
=
œœ# $
false
œœ% *
;
œœ* +
btnCancelar
–– 
.
–– 
Enabled
–– #
=
––$ %
false
––& +
;
––+ ,
btnEliminar
—— 
.
—— 
Enabled
—— #
=
——$ %
false
——& +
;
——+ ,
btnImprimir
““ 
.
““ 
Enabled
““ #
=
““$ %
true
““& *
;
““* +
btnActualizar
”” 
.
”” 
Enabled
”” %
=
””& '
false
””( -
;
””- .
btnAyuda
‘‘ 
.
‘‘ 
Enabled
‘‘  
=
‘‘! "
true
‘‘# '
;
‘‘' (
btnSalir
’’ 
.
’’ 
Enabled
’’  
=
’’! "
true
’’# '
;
’’' (
}
÷÷ 
}
◊◊ 	
public
ÿÿ 
void
ÿÿ 
metodoInsertar
ÿÿ "
(
ÿÿ" #
string
ÿÿ# )
query
ÿÿ* /
)
ÿÿ/ 0
{
ŸŸ 	
int
⁄⁄ 
ret
⁄⁄ 
;
⁄⁄ 
try
€€ 
{
‹‹ 
OdbcCommand
ﬁﬁ 
consulta
ﬁﬁ $
=
ﬁﬁ% &
new
ﬁﬁ' *
OdbcCommand
ﬁﬁ+ 6
(
ﬁﬁ6 7
query
ﬁﬁ7 <
,
ﬁﬁ< =
cn
ﬁﬁ> @
.
ﬁﬁ@ A
conexion
ﬁﬁA I
(
ﬁﬁI J
)
ﬁﬁJ K
)
ﬁﬁK L
;
ﬁﬁL M
consulta
ﬂﬂ 
.
ﬂﬂ 
ExecuteNonQuery
ﬂﬂ (
(
ﬂﬂ( )
)
ﬂﬂ) *
;
ﬂﬂ* +
ret
‡‡ 
=
‡‡ 
$num
‡‡ 
;
‡‡ 
}
‚‚ 
catch
‰‰ 
(
‰‰ 
OdbcException
‰‰  
ex
‰‰! #
)
‰‰# $
{
ÂÂ 
ret
ÁÁ 
=
ÁÁ 
$num
ÁÁ 
;
ÁÁ 
}
ËË 
}
ÈÈ 	
public
ÍÍ 
void
ÍÍ 
metodoModificar
ÍÍ #
(
ÍÍ# $
string
ÍÍ$ *
query
ÍÍ+ 0
)
ÍÍ0 1
{
ÎÎ 	
int
ÏÏ 
ret
ÏÏ 
;
ÏÏ 
try
ÌÌ 
{
ÓÓ 
OdbcCommand
 
consulta
 $
=
% &
new
' *
OdbcCommand
+ 6
(
6 7
query
7 <
,
< =
cn
> @
.
@ A
conexion
A I
(
I J
)
J K
)
K L
;
L M
consulta
ÒÒ 
.
ÒÒ 
ExecuteNonQuery
ÒÒ (
(
ÒÒ( )
)
ÒÒ) *
;
ÒÒ* +
ret
ÚÚ 
=
ÚÚ 
$num
ÚÚ 
;
ÚÚ 
}
ÙÙ 
catch
ˆˆ 
(
ˆˆ 
OdbcException
ˆˆ  
ex
ˆˆ! #
)
ˆˆ# $
{
˜˜ 
ret
˘˘ 
=
˘˘ 
$num
˘˘ 
;
˘˘ 
}
˙˙ 
}
˚˚ 	
public
¸¸ 
void
¸¸ 
metodoDarBaja
¸¸ !
(
¸¸! "
string
¸¸" (
query
¸¸) .
)
¸¸. /
{
˝˝ 	
int
˛˛ 
ret
˛˛ 
;
˛˛ 
try
ˇˇ 
{
ÄÄ 
OdbcCommand
ÇÇ 
consulta
ÇÇ $
=
ÇÇ% &
new
ÇÇ' *
OdbcCommand
ÇÇ+ 6
(
ÇÇ6 7
query
ÇÇ7 <
,
ÇÇ< =
cn
ÇÇ> @
.
ÇÇ@ A
conexion
ÇÇA I
(
ÇÇI J
)
ÇÇJ K
)
ÇÇK L
;
ÇÇL M
consulta
ÉÉ 
.
ÉÉ 
ExecuteNonQuery
ÉÉ (
(
ÉÉ( )
)
ÉÉ) *
;
ÉÉ* +
ret
ÑÑ 
=
ÑÑ 
$num
ÑÑ 
;
ÑÑ 
}
ÜÜ 
catch
àà 
(
àà 
OdbcException
àà  
ex
àà! #
)
àà# $
{
ââ 
ret
ãã 
=
ãã 
$num
ãã 
;
ãã 
}
åå 
}
çç 	
public
éé 
void
éé 
metodoEliminar
éé "
(
éé" #
string
éé# )
query
éé* /
)
éé/ 0
{
èè 	
int
êê 
ret
êê 
;
êê 
try
ëë 
{
íí 
OdbcCommand
îî 
consulta
îî $
=
îî% &
new
îî' *
OdbcCommand
îî+ 6
(
îî6 7
query
îî7 <
,
îî< =
cn
îî> @
.
îî@ A
conexion
îîA I
(
îîI J
)
îîJ K
)
îîK L
;
îîL M
consulta
ïï 
.
ïï 
ExecuteNonQuery
ïï (
(
ïï( )
)
ïï) *
;
ïï* +
ret
ññ 
=
ññ 
$num
ññ 
;
ññ 
}
óó 
catch
ôô 
(
ôô 
OdbcException
ôô  
ex
ôô! #
)
ôô# $
{
öö 
ret
úú 
=
úú 
$num
úú 
;
úú 
}
ùù 
}
ûû 	
public
üü 
	DataTable
üü 
ActualizarDGV
üü &
(
üü& '
string
üü' -
tabla
üü. 3
)
üü3 4
{
†† 	
Conexion
°° 
cn
°° 
=
°° 
new
°° 
Conexion
°° &
(
°°& '
)
°°' (
;
°°( )
string
¢¢ 
sql
¢¢ 
=
¢¢ 
$str
¢¢ )
+
¢¢* +
tabla
¢¢, 1
+
¢¢2 3
$str
¢¢4 7
+
¢¢8 9
$str
¢¢: J
;
¢¢J K
OdbcConnection
££ 
conn
££ 
=
££  !
cn
££" $
.
££$ %
conexion
££% -
(
££- .
)
££. /
;
££/ 0
OdbcDataAdapter
§§ 
	dataTable
§§ %
=
§§& '
new
§§( +
OdbcDataAdapter
§§, ;
(
§§; <
sql
§§< ?
,
§§? @
conn
§§A E
)
§§E F
;
§§F G
cn
•• 
.
•• 
desconexion
•• 
(
•• 
conn
•• 
)
••  
;
••  !
	DataTable
®® 
table
®® 
=
®® 
new
®® !
	DataTable
®®" +
(
®®+ ,
)
®®, -
;
®®- .
	dataTable
©© 
.
©© 
Fill
©© 
(
©© 
table
©©  
)
©©  !
;
©©! "
return
™™ 
table
™™ 
;
™™ 
}
´´ 	
public
¨¨ 
void
¨¨ 
	LlenarCBX
¨¨ 
(
¨¨ 
ComboBox
¨¨ &
cbx
¨¨' *
,
¨¨* +
string
¨¨, 2
tabla
¨¨3 8
,
¨¨8 9
string
¨¨: @
campobuscado
¨¨A M
)
¨¨M N
{
≠≠ 	
string
ÆÆ 
dato
ÆÆ 
=
ÆÆ 
$str
ÆÆ 
;
ÆÆ 
try
ØØ 
{
∞∞ 
cbx
±± 
.
±± 
Items
±± 
.
±± 
Clear
±± 
(
±±  
)
±±  !
;
±±! "
string
≤≤ 
insertQuery
≤≤ "
=
≤≤# $
$str
≤≤% 5
+
≤≤6 7
tabla
≤≤8 =
+
≤≤> ?
$str
≤≤@ V
;
≤≤V W
OdbcConnection
¥¥ 
conect
¥¥ %
=
¥¥& '
cn
¥¥( *
.
¥¥* +
conexion
¥¥+ 3
(
¥¥3 4
)
¥¥4 5
;
¥¥5 6
OdbcCommand
µµ 
command
µµ #
=
µµ$ %
new
µµ& )
OdbcCommand
µµ* 5
(
µµ5 6
insertQuery
µµ6 A
,
µµA B
conect
µµC I
)
µµI J
;
µµJ K
command
∂∂ 
.
∂∂ 
ExecuteNonQuery
∂∂ '
(
∂∂' (
)
∂∂( )
;
∂∂) *
OdbcDataReader
∂∂+ 9
	busquedac
∂∂: C
;
∂∂C D
	busquedac
∑∑ 
=
∑∑ 
command
∑∑ #
.
∑∑# $
ExecuteReader
∑∑$ 1
(
∑∑1 2
)
∑∑2 3
;
∑∑3 4
if
∏∏ 
(
∏∏ 
!
∏∏ 
	busquedac
∏∏ 
.
∏∏ 
HasRows
∏∏ &
)
∏∏& '
{
ππ 
}
ªª 
while
ºº 
(
ºº 
	busquedac
ºº  
.
ºº  !
Read
ºº! %
(
ºº% &
)
ºº& '
)
ºº' (
{
ΩΩ 
dato
ææ 
=
ææ 
	busquedac
ææ $
[
ææ$ %
campobuscado
ææ% 1
]
ææ1 2
.
ææ2 3
ToString
ææ3 ;
(
ææ; <
)
ææ< =
;
ææ= >
cbx
øø 
.
øø 
Items
øø 
.
øø 
Add
øø !
(
øø! "
dato
øø" &
)
øø& '
;
øø' (
}
¿¿ 
cn
¡¡ 
.
¡¡ 
desconexion
¡¡ 
(
¡¡ 
conect
¡¡ %
)
¡¡% &
;
¡¡& '
}
¬¬ 
catch
√√ 
(
√√ 
	Exception
√√ 
ex
√√ 
)
√√  
{
ƒƒ 
}
≈≈ 
}
∆∆ 	
public
«« 
void
«« 
	LlenarCat
«« 
(
«« 
ComboBox
«« &
cbx
««' *
,
««* +
string
««, 2
tabla
««3 8
,
««8 9
string
««: @
campobuscado
««A M
,
««M N
string
««O U
tipo
««V Z
,
««Z [
string
««\ b
catsup
««c i
)
««i j
{
»» 	
string
…… 
dato
…… 
=
…… 
$str
…… 
;
…… 
try
   
{
ÀÀ 
cbx
ÃÃ 
.
ÃÃ 
Items
ÃÃ 
.
ÃÃ 
Clear
ÃÃ 
(
ÃÃ  
)
ÃÃ  !
;
ÃÃ! "
string
ÕÕ 
insertQuery
ÕÕ "
=
ÕÕ# $
$str
ÕÕ% 5
+
ÕÕ6 7
tabla
ÕÕ8 =
+
ÕÕ> ?
$str
ÕÕ@ b
+
ÕÕc d
tipo
ÕÕe i
+
ÕÕj k
$str
ÕÕl ~
+ÕÕ Ä
catsupÕÕÅ á
+ÕÕà â
$strÕÕä é
;ÕÕé è
OdbcConnection
œœ 
conect
œœ %
=
œœ& '
cn
œœ( *
.
œœ* +
conexion
œœ+ 3
(
œœ3 4
)
œœ4 5
;
œœ5 6
OdbcCommand
–– 
command
–– #
=
––$ %
new
––& )
OdbcCommand
––* 5
(
––5 6
insertQuery
––6 A
,
––A B
conect
––C I
)
––I J
;
––J K
command
—— 
.
—— 
ExecuteNonQuery
—— '
(
——' (
)
——( )
;
——) *
OdbcDataReader
——+ 9
	busquedac
——: C
;
——C D
	busquedac
““ 
=
““ 
command
““ #
.
““# $
ExecuteReader
““$ 1
(
““1 2
)
““2 3
;
““3 4
if
”” 
(
”” 
!
”” 
	busquedac
”” 
.
”” 
HasRows
”” &
)
””& '
{
‘‘ 
}
÷÷ 
while
◊◊ 
(
◊◊ 
	busquedac
◊◊  
.
◊◊  !
Read
◊◊! %
(
◊◊% &
)
◊◊& '
)
◊◊' (
{
ÿÿ 
dato
ŸŸ 
=
ŸŸ 
	busquedac
ŸŸ $
[
ŸŸ$ %
campobuscado
ŸŸ% 1
]
ŸŸ1 2
.
ŸŸ2 3
ToString
ŸŸ3 ;
(
ŸŸ; <
)
ŸŸ< =
;
ŸŸ= >
cbx
⁄⁄ 
.
⁄⁄ 
Items
⁄⁄ 
.
⁄⁄ 
Add
⁄⁄ !
(
⁄⁄! "
dato
⁄⁄" &
)
⁄⁄& '
;
⁄⁄' (
}
€€ 
cn
‹‹ 
.
‹‹ 
desconexion
‹‹ 
(
‹‹ 
conect
‹‹ %
)
‹‹% &
;
‹‹& '
}
›› 
catch
ﬁﬁ 
(
ﬁﬁ 
	Exception
ﬁﬁ 
ex
ﬁﬁ 
)
ﬁﬁ  
{
ﬂﬂ 
}
‡‡ 
}
·· 	
public
‚‚ 
void
‚‚ 
LlenarUbicacion
‚‚ #
(
‚‚# $
ComboBox
‚‚$ ,
cbx
‚‚- 0
,
‚‚0 1
string
‚‚2 8
tabla
‚‚9 >
,
‚‚> ?
string
‚‚@ F
campobuscado
‚‚G S
,
‚‚S T
string
‚‚U [
bodega
‚‚\ b
)
‚‚b c
{
„„ 	
string
‰‰ 
dato
‰‰ 
=
‰‰ 
$str
‰‰ 
;
‰‰ 
try
ÂÂ 
{
ÊÊ 
cbx
ÁÁ 
.
ÁÁ 
Items
ÁÁ 
.
ÁÁ 
Clear
ÁÁ 
(
ÁÁ  
)
ÁÁ  !
;
ÁÁ! "
string
ËË 
insertQuery
ËË "
=
ËË# $
$str
ËË% 5
+
ËË6 7
tabla
ËË8 =
+
ËË> ?
$str
ËË@ f
+
ËËg h
bodega
ËËi o
+
ËËp q
$str
ËËr v
;
ËËv w
OdbcConnection
ÍÍ 
conect
ÍÍ %
=
ÍÍ& '
cn
ÍÍ( *
.
ÍÍ* +
conexion
ÍÍ+ 3
(
ÍÍ3 4
)
ÍÍ4 5
;
ÍÍ5 6
OdbcCommand
ÎÎ 
command
ÎÎ #
=
ÎÎ$ %
new
ÎÎ& )
OdbcCommand
ÎÎ* 5
(
ÎÎ5 6
insertQuery
ÎÎ6 A
,
ÎÎA B
conect
ÎÎC I
)
ÎÎI J
;
ÎÎJ K
command
ÏÏ 
.
ÏÏ 
ExecuteNonQuery
ÏÏ '
(
ÏÏ' (
)
ÏÏ( )
;
ÏÏ) *
OdbcDataReader
ÏÏ+ 9
	busquedac
ÏÏ: C
;
ÏÏC D
	busquedac
ÌÌ 
=
ÌÌ 
command
ÌÌ #
.
ÌÌ# $
ExecuteReader
ÌÌ$ 1
(
ÌÌ1 2
)
ÌÌ2 3
;
ÌÌ3 4
if
ÓÓ 
(
ÓÓ 
!
ÓÓ 
	busquedac
ÓÓ 
.
ÓÓ 
HasRows
ÓÓ &
)
ÓÓ& '
{
ÔÔ 
}
ÒÒ 
while
ÚÚ 
(
ÚÚ 
	busquedac
ÚÚ  
.
ÚÚ  !
Read
ÚÚ! %
(
ÚÚ% &
)
ÚÚ& '
)
ÚÚ' (
{
ÛÛ 
dato
ÙÙ 
=
ÙÙ 
	busquedac
ÙÙ $
[
ÙÙ$ %
campobuscado
ÙÙ% 1
]
ÙÙ1 2
.
ÙÙ2 3
ToString
ÙÙ3 ;
(
ÙÙ; <
)
ÙÙ< =
;
ÙÙ= >
cbx
ıı 
.
ıı 
Items
ıı 
.
ıı 
Add
ıı !
(
ıı! "
dato
ıı" &
)
ıı& '
;
ıı' (
}
ˆˆ 
cn
˜˜ 
.
˜˜ 
desconexion
˜˜ 
(
˜˜ 
conect
˜˜ %
)
˜˜% &
;
˜˜& '
}
¯¯ 
catch
˘˘ 
(
˘˘ 
	Exception
˘˘ 
ex
˘˘ 
)
˘˘  
{
˙˙ 
}
˚˚ 
}
¸¸ 	
public
˝˝ 
	DataTable
˝˝ 
LlenarProveedores
˝˝ *
(
˝˝* +
string
˝˝+ 1
tabla
˝˝2 7
)
˝˝7 8
{
˛˛ 	
Conexion
ˇˇ 
cn
ˇˇ 
=
ˇˇ 
new
ˇˇ 
Conexion
ˇˇ &
(
ˇˇ& '
)
ˇˇ' (
;
ˇˇ( )
string
ÄÄ 
sql
ÄÄ 
=
ÄÄ 
$str
ÄÄ 4
+
ÄÄ5 6
tabla
ÄÄ7 <
+
ÄÄ= >
$str
ÄÄ? B
+
ÄÄC D
$str
ÄÄE U
;
ÄÄU V
OdbcConnection
ÅÅ 
conn
ÅÅ 
=
ÅÅ  !
cn
ÅÅ" $
.
ÅÅ$ %
conexion
ÅÅ% -
(
ÅÅ- .
)
ÅÅ. /
;
ÅÅ/ 0
OdbcDataAdapter
ÇÇ 
	dataTable
ÇÇ %
=
ÇÇ& '
new
ÇÇ( +
OdbcDataAdapter
ÇÇ, ;
(
ÇÇ; <
sql
ÇÇ< ?
,
ÇÇ? @
conn
ÇÇA E
)
ÇÇE F
;
ÇÇF G
cn
ÉÉ 
.
ÉÉ 
desconexion
ÉÉ 
(
ÉÉ 
conn
ÉÉ 
)
ÉÉ  
;
ÉÉ  !
	DataTable
ÜÜ 
table
ÜÜ 
=
ÜÜ 
new
ÜÜ !
	DataTable
ÜÜ" +
(
ÜÜ+ ,
)
ÜÜ, -
;
ÜÜ- .
	dataTable
áá 
.
áá 
Fill
áá 
(
áá 
table
áá  
)
áá  !
;
áá! "
return
àà 
table
àà 
;
àà 
}
ââ 	
public
ää 
void
ää 
IDCAT
ää 
(
ää 
TextBox
ää !
textbox
ää" )
,
ää) *
string
ää+ 1
tabla
ää2 7
,
ää7 8
string
ää9 ?
campobuscado
ää@ L
,
ääL M
string
ääN T
nombre
ääU [
,
ää[ \
string
ää] c
tipo
ääd h
,
ääh i
string
ääj p
catsup
ääq w
)
ääw x
{
ãã 	
string
åå 
dato
åå 
=
åå 
$str
åå 
;
åå 
try
çç 
{
éé 
textbox
èè 
.
èè 
Text
èè 
=
èè 
$str
èè !
;
èè! "
string
êê 
insertQuery
êê "
=
êê# $
$str
êê% 5
+
êê6 7
tabla
êê8 =
+
êê> ?
$str
êê@ d
+
êêe f
nombre
êêg m
+
êên o
$strêêp Ä
+êêÅ Ç
tipoêêÉ á
+êêà â
$strêêä ú
+êêù û
catsupêêü •
+êê¶ ß
$strêê® ¨
;êê¨ ≠
OdbcConnection
íí 
conect
íí %
=
íí& '
cn
íí( *
.
íí* +
conexion
íí+ 3
(
íí3 4
)
íí4 5
;
íí5 6
OdbcCommand
ìì 
command
ìì #
=
ìì$ %
new
ìì& )
OdbcCommand
ìì* 5
(
ìì5 6
insertQuery
ìì6 A
,
ììA B
conect
ììC I
)
ììI J
;
ììJ K
command
îî 
.
îî 
ExecuteNonQuery
îî '
(
îî' (
)
îî( )
;
îî) *
OdbcDataReader
îî+ 9
	busquedac
îî: C
;
îîC D
	busquedac
ïï 
=
ïï 
command
ïï #
.
ïï# $
ExecuteReader
ïï$ 1
(
ïï1 2
)
ïï2 3
;
ïï3 4
if
ññ 
(
ññ 
!
ññ 
	busquedac
ññ 
.
ññ 
HasRows
ññ &
)
ññ& '
{
óó 
}
ôô 
while
öö 
(
öö 
	busquedac
öö  
.
öö  !
Read
öö! %
(
öö% &
)
öö& '
)
öö' (
{
õõ 
dato
úú 
=
úú 
	busquedac
úú $
[
úú$ %
campobuscado
úú% 1
]
úú1 2
.
úú2 3
ToString
úú3 ;
(
úú; <
)
úú< =
;
úú= >
textbox
ùù 
.
ùù 
Text
ùù  
=
ùù! "
dato
ùù# '
;
ùù' (
}
ûû 
cn
üü 
.
üü 
desconexion
üü 
(
üü 
conect
üü %
)
üü% &
;
üü& '
}
†† 
catch
°° 
(
°° 
	Exception
°° 
ex
°° 
)
°°  
{
¢¢ 
}
££ 
}
§§ 	
public
•• 
Boolean
••  
encuentraProveedor
•• )
(
••) *
string
••* 0
fkproveedore
••1 =
,
••= >
string
••? E
fkproveedor
••F Q
,
••Q R
string
••S Y
nombre
••Z `
)
••` a
{
¶¶ 	
string
ßß 
dato
ßß 
=
ßß 
$str
ßß 
;
ßß 
Boolean
ßß %
	chequeado
ßß& /
=
ßß/ 0
false
ßß1 6
;
ßß6 7
try
®® 
{
©© 
string
™™ 
insertQuery
™™ "
=
™™# $
$str
™™% x
+
™™y z
fkproveedore™™{ á
+™™à â
$str™™ä ¨
+™™≠ Æ
fkproveedor™™Ø ∫
+™™ª º
$str™™Ω ≥
+™™¥ µ
nombre™™∂ º
+™™Ω æ
$str™™ø √
;™™√ ƒ
OdbcConnection
¨¨ 
conect
¨¨ %
=
¨¨& '
cn
¨¨( *
.
¨¨* +
conexion
¨¨+ 3
(
¨¨3 4
)
¨¨4 5
;
¨¨5 6
OdbcCommand
≠≠ 
command
≠≠ #
=
≠≠$ %
new
≠≠& )
OdbcCommand
≠≠* 5
(
≠≠5 6
insertQuery
≠≠6 A
,
≠≠A B
conect
≠≠C I
)
≠≠I J
;
≠≠J K
command
ÆÆ 
.
ÆÆ 
ExecuteNonQuery
ÆÆ '
(
ÆÆ' (
)
ÆÆ( )
;
ÆÆ) *
OdbcDataReader
ÆÆ+ 9
	busquedac
ÆÆ: C
;
ÆÆC D
	busquedac
ØØ 
=
ØØ 
command
ØØ #
.
ØØ# $
ExecuteReader
ØØ$ 1
(
ØØ1 2
)
ØØ2 3
;
ØØ3 4
if
∞∞ 
(
∞∞ 
!
∞∞ 
	busquedac
∞∞ 
.
∞∞ 
HasRows
∞∞ &
)
∞∞& '
{
±± 
	chequeado
≤≤ 
=
≤≤ 
false
≤≤  %
;
≤≤% &
}
≥≥ 
while
¥¥ 
(
¥¥ 
	busquedac
¥¥  
.
¥¥  !
Read
¥¥! %
(
¥¥% &
)
¥¥& '
)
¥¥' (
{
µµ 
	chequeado
∂∂ 
=
∂∂ 
true
∂∂  $
;
∂∂$ %
}
∑∑ 
cn
∏∏ 
.
∏∏ 
desconexion
∏∏ 
(
∏∏ 
conect
∏∏ %
)
∏∏% &
;
∏∏& '
}
ππ 
catch
∫∫ 
(
∫∫ 
	Exception
∫∫ 
ex
∫∫ 
)
∫∫  
{
ªª 
}
ºº 
return
ΩΩ 
	chequeado
ΩΩ 
;
ΩΩ 
}
ææ 	
public
øø 
Boolean
øø 
idcoincidente
øø $
(
øø$ %
string
øø% +
tabla
øø, 1
,
øø1 2
string
øø3 9
pkid
øø: >
)
øø> ?
{
¿¿ 	
string
¡¡ 
dato
¡¡ 
=
¡¡ 
$str
¡¡ 
;
¡¡ 
Boolean
¡¡ %
	chequeado
¡¡& /
=
¡¡0 1
false
¡¡2 7
;
¡¡7 8
try
¬¬ 
{
√√ 
string
ƒƒ 
insertQuery
ƒƒ "
=
ƒƒ# $
$str
ƒƒ% 5
+
ƒƒ6 7
tabla
ƒƒ8 =
+
ƒƒ> ?
$str
ƒƒ@ R
+
ƒƒS T
pkid
ƒƒU Y
+
ƒƒZ [
$str
ƒƒ\ `
;
ƒƒ` a
OdbcConnection
∆∆ 
conect
∆∆ %
=
∆∆& '
cn
∆∆( *
.
∆∆* +
conexion
∆∆+ 3
(
∆∆3 4
)
∆∆4 5
;
∆∆5 6
OdbcCommand
«« 
command
«« #
=
««$ %
new
««& )
OdbcCommand
««* 5
(
««5 6
insertQuery
««6 A
,
««A B
conect
««C I
)
««I J
;
««J K
command
»» 
.
»» 
ExecuteNonQuery
»» '
(
»»' (
)
»»( )
;
»») *
OdbcDataReader
»»+ 9
	busquedac
»»: C
;
»»C D
	busquedac
…… 
=
…… 
command
…… #
.
……# $
ExecuteReader
……$ 1
(
……1 2
)
……2 3
;
……3 4
if
   
(
   
!
   
	busquedac
   
.
   
HasRows
   &
)
  & '
{
ÀÀ 
	chequeado
ÃÃ 
=
ÃÃ 
false
ÃÃ  %
;
ÃÃ% &
}
ÕÕ 
while
ŒŒ 
(
ŒŒ 
	busquedac
ŒŒ  
.
ŒŒ  !
Read
ŒŒ! %
(
ŒŒ% &
)
ŒŒ& '
)
ŒŒ' (
{
œœ 
	chequeado
–– 
=
–– 
true
––  $
;
––$ %
}
—— 
cn
““ 
.
““ 
desconexion
““ 
(
““ 
conect
““ %
)
““% &
;
““& '
}
”” 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
ex
‘‘ 
)
‘‘  
{
’’ 
}
÷÷ 
return
◊◊ 
	chequeado
◊◊ 
;
◊◊ 
}
ÿÿ 	
public
ŸŸ 
Boolean
ŸŸ 
registroexiste
ŸŸ %
(
ŸŸ% &
string
ŸŸ& ,
tabla
ŸŸ- 2
,
ŸŸ2 3
string
ŸŸ4 :
fkproveedores
ŸŸ; H
,
ŸŸH I
string
ŸŸJ P
fkproveedore
ŸŸQ ]
)
ŸŸ] ^
{
⁄⁄ 	
string
€€ 
dato
€€ 
=
€€ 
$str
€€ 
;
€€ 
Boolean
€€ %
	chequeado
€€& /
=
€€0 1
false
€€2 7
;
€€7 8
try
‹‹ 
{
›› 
string
ﬁﬁ 
insertQuery
ﬁﬁ "
=
ﬁﬁ# $
$str
ﬁﬁ% 5
+
ﬁﬁ6 7
tabla
ﬁﬁ8 =
+
ﬁﬁ> ?
$str
ﬁﬁ@ Y
+
ﬁﬁZ [
fkproveedores
ﬁﬁ\ i
+
ﬁﬁj k
$strﬁﬁl Ñ
+ﬁﬁÖ Ü
fkproveedoreﬁﬁá ì
+ﬁﬁî ï
$strﬁﬁï ô
;ﬁﬁô ö
OdbcConnection
‡‡ 
conect
‡‡ %
=
‡‡& '
cn
‡‡( *
.
‡‡* +
conexion
‡‡+ 3
(
‡‡3 4
)
‡‡4 5
;
‡‡5 6
OdbcCommand
·· 
command
·· #
=
··$ %
new
··& )
OdbcCommand
··* 5
(
··5 6
insertQuery
··6 A
,
··A B
conect
··C I
)
··I J
;
··J K
command
‚‚ 
.
‚‚ 
ExecuteNonQuery
‚‚ '
(
‚‚' (
)
‚‚( )
;
‚‚) *
OdbcDataReader
‚‚+ 9
	busquedac
‚‚: C
;
‚‚C D
	busquedac
„„ 
=
„„ 
command
„„ #
.
„„# $
ExecuteReader
„„$ 1
(
„„1 2
)
„„2 3
;
„„3 4
if
‰‰ 
(
‰‰ 
!
‰‰ 
	busquedac
‰‰ 
.
‰‰ 
HasRows
‰‰ &
)
‰‰& '
{
ÂÂ 
	chequeado
ÊÊ 
=
ÊÊ 
false
ÊÊ  %
;
ÊÊ% &
}
ÁÁ 
while
ËË 
(
ËË 
	busquedac
ËË  
.
ËË  !
Read
ËË! %
(
ËË% &
)
ËË& '
)
ËË' (
{
ÈÈ 
	chequeado
ÍÍ 
=
ÍÍ 
true
ÍÍ  $
;
ÍÍ$ %
}
ÎÎ 
cn
ÏÏ 
.
ÏÏ 
desconexion
ÏÏ 
(
ÏÏ 
conect
ÏÏ %
)
ÏÏ% &
;
ÏÏ& '
}
ÌÌ 
catch
ÓÓ 
(
ÓÓ 
	Exception
ÓÓ 
ex
ÓÓ 
)
ÓÓ  
{
ÔÔ 
}
 
return
ÒÒ 
	chequeado
ÒÒ 
;
ÒÒ 
}
ÚÚ 	
public
ÛÛ 
void
ÛÛ 
LlenarCBXProducto
ÛÛ %
(
ÛÛ% &
ComboBox
ÛÛ& .
cbx
ÛÛ/ 2
,
ÛÛ2 3
string
ÛÛ4 :
tabla
ÛÛ; @
,
ÛÛ@ A
string
ÛÛB H
campobuscado
ÛÛI U
,
ÛÛU V
string
ÛÛW ]

inventario
ÛÛ^ h
)
ÛÛh i
{
ÙÙ 	
string
ıı 
dato
ıı 
=
ıı 
$str
ıı 
;
ıı 
try
ˆˆ 
{
˜˜ 
cbx
¯¯ 
.
¯¯ 
Items
¯¯ 
.
¯¯ 
Clear
¯¯ 
(
¯¯  
)
¯¯  !
;
¯¯! "
string
˘˘ 
insertQuery
˘˘ "
=
˘˘# $
$str
˘˘% 5
+
˘˘6 7
tabla
˘˘8 =
+
˘˘> ?
$str
˘˘@ k
+
˘˘l m

inventario
˘˘n x
+
˘˘y z
$str
˘˘{ 
;˘˘ Ä
OdbcConnection
˚˚ 
conect
˚˚ %
=
˚˚& '
cn
˚˚( *
.
˚˚* +
conexion
˚˚+ 3
(
˚˚3 4
)
˚˚4 5
;
˚˚5 6
OdbcCommand
¸¸ 
command
¸¸ #
=
¸¸$ %
new
¸¸& )
OdbcCommand
¸¸* 5
(
¸¸5 6
insertQuery
¸¸6 A
,
¸¸A B
conect
¸¸C I
)
¸¸I J
;
¸¸J K
command
˝˝ 
.
˝˝ 
ExecuteNonQuery
˝˝ '
(
˝˝' (
)
˝˝( )
;
˝˝) *
OdbcDataReader
˝˝+ 9
	busquedac
˝˝: C
;
˝˝C D
	busquedac
˛˛ 
=
˛˛ 
command
˛˛ #
.
˛˛# $
ExecuteReader
˛˛$ 1
(
˛˛1 2
)
˛˛2 3
;
˛˛3 4
if
ˇˇ 
(
ˇˇ 
!
ˇˇ 
	busquedac
ˇˇ 
.
ˇˇ 
HasRows
ˇˇ &
)
ˇˇ& '
{
ÄÄ 
}
ÇÇ 
while
ÉÉ 
(
ÉÉ 
	busquedac
ÉÉ  
.
ÉÉ  !
Read
ÉÉ! %
(
ÉÉ% &
)
ÉÉ& '
)
ÉÉ' (
{
ÑÑ 
dato
ÖÖ 
=
ÖÖ 
	busquedac
ÖÖ $
[
ÖÖ$ %
campobuscado
ÖÖ% 1
]
ÖÖ1 2
.
ÖÖ2 3
ToString
ÖÖ3 ;
(
ÖÖ; <
)
ÖÖ< =
;
ÖÖ= >
cbx
ÜÜ 
.
ÜÜ 
Items
ÜÜ 
.
ÜÜ 
Add
ÜÜ !
(
ÜÜ! "
dato
ÜÜ" &
)
ÜÜ& '
;
ÜÜ' (
}
áá 
cn
àà 
.
àà 
desconexion
àà 
(
àà 
conect
àà %
)
àà% &
;
àà& '
}
ââ 
catch
ää 
(
ää 
	Exception
ää 
ex
ää 
)
ää  
{
ãã 
}
åå 
}
çç 	
public
éé 
void
éé 

IDProducto
éé 
(
éé 
TextBox
éé &
textbox
éé' .
,
éé. /
string
éé0 6
tabla
éé7 <
,
éé< =
string
éé> D
campobuscado
ééE Q
,
ééQ R
string
ééS Y
nombre
ééZ `
,
éé` a
string
ééb h

inventario
ééi s
)
éés t
{
èè 	
string
êê 
dato
êê 
=
êê 
$str
êê 
;
êê 
try
ëë 
{
íí 
textbox
ìì 
.
ìì 
Text
ìì 
=
ìì 
$str
ìì !
;
ìì! "
string
îî 
insertQuery
îî "
=
îî# $
$str
îî% 5
+
îî6 7
tabla
îî8 =
+
îî> ?
$str
îî@ d
+
îîe f
nombre
îîg m
+
îîn o
$strîîp â
+îîä ã

inventarioîîå ñ
+îîó ò
$strîîô ù
;îîù û
OdbcConnection
ññ 
conect
ññ %
=
ññ& '
cn
ññ( *
.
ññ* +
conexion
ññ+ 3
(
ññ3 4
)
ññ4 5
;
ññ5 6
OdbcCommand
óó 
command
óó #
=
óó$ %
new
óó& )
OdbcCommand
óó* 5
(
óó5 6
insertQuery
óó6 A
,
óóA B
conect
óóC I
)
óóI J
;
óóJ K
command
òò 
.
òò 
ExecuteNonQuery
òò '
(
òò' (
)
òò( )
;
òò) *
OdbcDataReader
òò+ 9
	busquedac
òò: C
;
òòC D
	busquedac
ôô 
=
ôô 
command
ôô #
.
ôô# $
ExecuteReader
ôô$ 1
(
ôô1 2
)
ôô2 3
;
ôô3 4
if
öö 
(
öö 
!
öö 
	busquedac
öö 
.
öö 
HasRows
öö &
)
öö& '
{
õõ 
}
ùù 
while
ûû 
(
ûû 
	busquedac
ûû  
.
ûû  !
Read
ûû! %
(
ûû% &
)
ûû& '
)
ûû' (
{
üü 
dato
†† 
=
†† 
	busquedac
†† $
[
††$ %
campobuscado
††% 1
]
††1 2
.
††2 3
ToString
††3 ;
(
††; <
)
††< =
;
††= >
textbox
°° 
.
°° 
Text
°°  
=
°°! "
dato
°°# '
;
°°' (
}
¢¢ 
cn
££ 
.
££ 
desconexion
££ 
(
££ 
conect
££ %
)
££% &
;
££& '
}
§§ 
catch
•• 
(
•• 
	Exception
•• 
ex
•• 
)
••  
{
¶¶ 
}
ßß 
}
®® 	
public
©© 
void
©© 
NombreIDProducto
©© $
(
©©$ %
ComboBox
©©% -
combo
©©. 3
,
©©3 4
string
©©5 ;
tabla
©©< A
,
©©A B
string
©©B H
campobuscado
©©I U
,
©©U V
string
©©W ]
pkid
©©^ b
,
©©b c
string
©©d j

inventario
©©k u
)
©©u v
{
™™ 	
string
´´ 
dato
´´ 
=
´´ 
$str
´´ 
;
´´ 
try
¨¨ 
{
≠≠ 
string
ØØ 
insertQuery
ØØ "
=
ØØ# $
$str
ØØ% 5
+
ØØ6 7
tabla
ØØ8 =
+
ØØ> ?
$str
ØØ@ b
+
ØØc d
pkid
ØØe i
+
ØØj k
$strØØl Ö
+ØØÜ á

inventarioØØà í
+ØØì î
$strØØï ô
;ØØô ö
OdbcConnection
±± 
conect
±± %
=
±±& '
cn
±±( *
.
±±* +
conexion
±±+ 3
(
±±3 4
)
±±4 5
;
±±5 6
OdbcCommand
≤≤ 
command
≤≤ #
=
≤≤$ %
new
≤≤& )
OdbcCommand
≤≤* 5
(
≤≤5 6
insertQuery
≤≤6 A
,
≤≤A B
conect
≤≤C I
)
≤≤I J
;
≤≤J K
command
≥≥ 
.
≥≥ 
ExecuteNonQuery
≥≥ '
(
≥≥' (
)
≥≥( )
;
≥≥) *
OdbcDataReader
≥≥+ 9
	busquedac
≥≥: C
;
≥≥C D
	busquedac
¥¥ 
=
¥¥ 
command
¥¥ #
.
¥¥# $
ExecuteReader
¥¥$ 1
(
¥¥1 2
)
¥¥2 3
;
¥¥3 4
if
µµ 
(
µµ 
!
µµ 
	busquedac
µµ 
.
µµ 
HasRows
µµ &
)
µµ& '
{
∂∂ 
}
∏∏ 
while
ππ 
(
ππ 
	busquedac
ππ  
.
ππ  !
Read
ππ! %
(
ππ% &
)
ππ& '
)
ππ' (
{
∫∫ 
dato
ªª 
=
ªª 
	busquedac
ªª $
[
ªª$ %
campobuscado
ªª% 1
]
ªª1 2
.
ªª2 3
ToString
ªª3 ;
(
ªª; <
)
ªª< =
;
ªª= >
combo
ºº 
.
ºº 
SelectedItem
ºº &
=
ºº' (
dato
ºº) -
;
ºº- .
}
ΩΩ 
cn
ææ 
.
ææ 
desconexion
ææ 
(
ææ 
conect
ææ %
)
ææ% &
;
ææ& '
}
øø 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿ 
ex
¿¿ 
)
¿¿  
{
¡¡ 
}
¬¬ 
}
√√ 	
public
ƒƒ 
void
ƒƒ 
convertirFechaDTP
ƒƒ %
(
ƒƒ% &
DateTimePicker
ƒƒ& 4
dtp
ƒƒ5 8
,
ƒƒ8 9
TextBox
ƒƒ: A
txt
ƒƒB E
)
ƒƒE F
{
≈≈ 	
DateTime
∆∆ 
date
∆∆ 
=
∆∆ 
new
∆∆ 
DateTime
∆∆  (
(
∆∆( )
)
∆∆) *
;
∆∆* +
date
»» 
=
»» 
dtp
»» 
.
»» 
Value
»» 
;
»» 
string
…… 
fecha
…… 
=
…… 
dtp
…… 
.
…… 
Value
…… $
.
……$ %
ToString
……% -
(
……- .
$str
……. :
)
……: ;
;
……; <
txt
   
.
   
Text
   
=
   
fecha
   
;
   
}
ÀÀ 	
public
ÃÃ 
void
ÃÃ !
convertirFechaMySQL
ÃÃ '
(
ÃÃ' (
DateTimePicker
ÃÃ( 6
dtp
ÃÃ7 :
,
ÃÃ: ;
TextBox
ÃÃ< C
txt
ÃÃD G
)
ÃÃG H
{
ÕÕ 	
DateTime
ŒŒ 
fecha
ŒŒ 
=
ŒŒ 
new
ŒŒ  
DateTime
ŒŒ! )
(
ŒŒ) *
)
ŒŒ* +
;
ŒŒ+ ,
fecha
œœ 
=
œœ 
Convert
œœ 
.
œœ 

ToDateTime
œœ &
(
œœ& '
txt
œœ' *
.
œœ* +
Text
œœ+ /
)
œœ/ 0
;
œœ0 1
dtp
–– 
.
–– 
Value
–– 
=
–– 
fecha
–– 
.
–– 
Date
–– "
;
––" #
}
—— 	
public
““ 
string
““ 
	BuscaDato
““ 
(
““  
string
““  &
tabla
““' ,
,
““, -
string
““. 4
campo
““5 :
,
““: ;
string
““< B
campobuscado
““C O
,
““O P
string
““Q W
datoreferencia
““X f
)
““f g
{
”” 	
string
‘‘ 
dato
‘‘ 
=
‘‘ 
$str
‘‘ 
;
‘‘ 
try
’’ 
{
÷÷ 
string
◊◊ 
insertQuery
◊◊ "
=
◊◊# $
$str
◊◊% 5
+
◊◊6 7
tabla
◊◊8 =
+
◊◊> ?
$str
◊◊@ I
+
◊◊J K
campobuscado
◊◊L X
+
◊◊Y Z
$str
◊◊[ a
+
◊◊b c
datoreferencia
◊◊d r
+
◊◊s t
$str
◊◊u y
;
◊◊y z
OdbcConnection
ŸŸ 
conect
ŸŸ %
=
ŸŸ& '
cn
ŸŸ( *
.
ŸŸ* +
conexion
ŸŸ+ 3
(
ŸŸ3 4
)
ŸŸ4 5
;
ŸŸ5 6
OdbcCommand
⁄⁄ 
command
⁄⁄ #
=
⁄⁄$ %
new
⁄⁄& )
OdbcCommand
⁄⁄* 5
(
⁄⁄5 6
insertQuery
⁄⁄6 A
,
⁄⁄A B
conect
⁄⁄C I
)
⁄⁄I J
;
⁄⁄J K
command
€€ 
.
€€ 
ExecuteNonQuery
€€ '
(
€€' (
)
€€( )
;
€€) *
OdbcDataReader
€€+ 9
	busquedac
€€: C
;
€€C D
	busquedac
‹‹ 
=
‹‹ 
command
‹‹ #
.
‹‹# $
ExecuteReader
‹‹$ 1
(
‹‹1 2
)
‹‹2 3
;
‹‹3 4
if
›› 
(
›› 
!
›› 
	busquedac
›› 
.
›› 
HasRows
›› &
)
››& '
{
ﬁﬁ 
}
‡‡ 
if
·· 
(
·· 
	busquedac
·· 
.
·· 
Read
·· "
(
··" #
)
··# $
)
··$ %
{
‚‚ 
dato
„„ 
=
„„ 
	busquedac
„„ $
[
„„$ %
campo
„„% *
]
„„* +
.
„„+ ,
ToString
„„, 4
(
„„4 5
)
„„5 6
;
„„6 7
}
‰‰ 
cn
ÂÂ 
.
ÂÂ 
desconexion
ÂÂ 
(
ÂÂ 
conect
ÂÂ %
)
ÂÂ% &
;
ÂÂ& '
return
ÊÊ 
dato
ÊÊ 
;
ÊÊ 
}
ÁÁ 
catch
ËË 
(
ËË 
	Exception
ËË 
ex
ËË 
)
ËË  
{
ÈÈ 
return
ÍÍ 
dato
ÍÍ 
;
ÍÍ 
}
ÎÎ 
}
ÏÏ 	
public
ÌÌ 
	DataTable
ÌÌ 
ActualizaDetalles
ÌÌ *
(
ÌÌ* +
string
ÌÌ+ 1
tabla
ÌÌ2 7
,
ÌÌ7 8
string
ÌÌ9 ?

cotizacion
ÌÌ@ J
)
ÌÌJ K
{
ÓÓ 	
Conexion
ÔÔ 
cn
ÔÔ 
=
ÔÔ 
new
ÔÔ 
Conexion
ÔÔ &
(
ÔÔ& '
)
ÔÔ' (
;
ÔÔ( )
string
 
sql
 
=
 
$str
 )
+
* +
tabla
, 1
+
2 3
$str
4 N
+
O P

cotizacion
Q [
+
\ ]
$str
^ p
;
p q
OdbcConnection
ÒÒ 
conn
ÒÒ 
=
ÒÒ  !
cn
ÒÒ" $
.
ÒÒ$ %
conexion
ÒÒ% -
(
ÒÒ- .
)
ÒÒ. /
;
ÒÒ/ 0
OdbcDataAdapter
ÚÚ 
	dataTable
ÚÚ %
=
ÚÚ& '
new
ÚÚ( +
OdbcDataAdapter
ÚÚ, ;
(
ÚÚ; <
sql
ÚÚ< ?
,
ÚÚ? @
conn
ÚÚA E
)
ÚÚE F
;
ÚÚF G
cn
ÛÛ 
.
ÛÛ 
desconexion
ÛÛ 
(
ÛÛ 
conn
ÛÛ 
)
ÛÛ  
;
ÛÛ  !
	DataTable
ˆˆ 
table
ˆˆ 
=
ˆˆ 
new
ˆˆ !
	DataTable
ˆˆ" +
(
ˆˆ+ ,
)
ˆˆ, -
;
ˆˆ- .
	dataTable
˜˜ 
.
˜˜ 
Fill
˜˜ 
(
˜˜ 
table
˜˜  
)
˜˜  !
;
˜˜! "
return
¯¯ 
table
¯¯ 
;
¯¯ 
}
˘˘ 	
public
˙˙ 
	DataTable
˙˙ 
ObtenerDetalles
˙˙ (
(
˙˙( )
string
˙˙) /

cotizacion
˙˙0 :
,
˙˙: ;
string
˙˙< B
total
˙˙C H
)
˙˙H I
{
˚˚ 	
Conexion
¸¸ 
cn
¸¸ 
=
¸¸ 
new
¸¸ 
Conexion
¸¸ &
(
¸¸& '
)
¸¸' (
;
¸¸( )
string
˝˝ 
sql
˝˝ 
=
˝˝ 
$str˝˝ §
+˝˝• ¶

cotizacion˝˝ß ±
+˝˝≤ ≥
$str˝˝¥ ∏
;˝˝∏ π
OdbcConnection
˛˛ 
conn
˛˛ 
=
˛˛  !
cn
˛˛" $
.
˛˛$ %
conexion
˛˛% -
(
˛˛- .
)
˛˛. /
;
˛˛/ 0
OdbcDataAdapter
ˇˇ 
	dataTable
ˇˇ %
=
ˇˇ& '
new
ˇˇ( +
OdbcDataAdapter
ˇˇ, ;
(
ˇˇ; <
sql
ˇˇ< ?
,
ˇˇ? @
conn
ˇˇA E
)
ˇˇE F
;
ˇˇF G
cn
ÄÄ 
.
ÄÄ 
desconexion
ÄÄ 
(
ÄÄ 
conn
ÄÄ 
)
ÄÄ  
;
ÄÄ  !
	DataTable
ÉÉ 
table
ÉÉ 
=
ÉÉ 
new
ÉÉ !
	DataTable
ÉÉ" +
(
ÉÉ+ ,
)
ÉÉ, -
;
ÉÉ- .
	dataTable
ÑÑ 
.
ÑÑ 
Fill
ÑÑ 
(
ÑÑ 
table
ÑÑ  
)
ÑÑ  !
;
ÑÑ! "
return
ÜÜ 
table
ÜÜ 
;
ÜÜ 
}
áá 	
public
àà 
	DataTable
àà  
CargarRecordatorio
àà +
(
àà+ ,
string
àà, 2
sql
àà3 6
)
àà6 7
{
ââ 	
Conexion
ää 
cn
ää 
=
ää 
new
ää 
Conexion
ää &
(
ää& '
)
ää' (
;
ää( )
OdbcConnection
åå 
conn
åå 
=
åå  !
cn
åå" $
.
åå$ %
conexion
åå% -
(
åå- .
)
åå. /
;
åå/ 0
OdbcDataAdapter
çç 
	dataTable
çç %
=
çç& '
new
çç( +
OdbcDataAdapter
çç, ;
(
çç; <
sql
çç< ?
,
çç? @
conn
ççA E
)
ççE F
;
ççF G
cn
éé 
.
éé 
desconexion
éé 
(
éé 
conn
éé 
)
éé  
;
éé  !
	DataTable
ëë 
table
ëë 
=
ëë 
new
ëë !
	DataTable
ëë" +
(
ëë+ ,
)
ëë, -
;
ëë- .
	dataTable
íí 
.
íí 
Fill
íí 
(
íí 
table
íí  
)
íí  !
;
íí! "
return
îî 
table
îî 
;
îî 
}
ïï 	
}
ññ 
}óó 