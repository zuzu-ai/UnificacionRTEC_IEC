€
KF:\Proyecto de graduacion\ProyectoGraduacion\CapaModeloProyecto\Conexion.cs
	namespace 	
CapaModeloProyecto
 
{		 
public

 

class

 
Conexion

 
{ 
public 
OdbcConnection 
conexion &
(& '
)' (
{ 	
OdbcConnection 
conn 
=  !
new" %
OdbcConnection& 4
(4 5
$str5 F
)F G
;G H
try 
{ 
conn 
. 
Open 
( 
) 
; 
Console 
. 
	WriteLine !
(! "
$str" +
)+ ,
;, -
} 
catch 
( 
OdbcException  
)  !
{ 
Console 
. 
	WriteLine !
(! "
$str" .
). /
;/ 0
} 
return 
conn 
; 
} 	
public 
void 
desconexion 
(  
OdbcConnection  .
conn/ 3
)3 4
{ 	
try 
{ 
conn   
.   
Close   
(   
)   
;   
Console!! 
.!! 
	WriteLine!! !
(!!! "
$str!!" 3
)!!3 4
;!!4 5
}"" 
catch## 
(## 
OdbcException##  
)##  !
{$$ 
Console%% 
.%% 
	WriteLine%% !
(%%! "
$str%%" .
)%%. /
;%%/ 0
}&& 
}'' 	
}(( 
})) Ö
ZF:\Proyecto de graduacion\ProyectoGraduacion\CapaModeloProyecto\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str -
)- .
]. /
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str /
)/ 0
]0 1
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *‚À
MF:\Proyecto de graduacion\ProyectoGraduacion\CapaModeloProyecto\Sentencias.cs
	namespace

 	
CapaModeloProyecto


 
{ 
public 

class 

Sentencias 
{ 
	DataTable 
tabla 
= 
new 
	DataTable '
(' (
)( )
;) *
private 
Conexion 
cn 
= 
new !
Conexion" *
(* +
)+ ,
;, -
public 
byte 
[ 
] 
obtenerByte !
(! "
string" (
id) +
)+ ,
{ 	
int 

bufferSize 
= 
$num  
;  !
byte" &
[& '
]' (
bytefoto) 1
=2 3
new4 7
byte8 <
[< =

bufferSize= G
]G H
;H I
byte 
[ 
] 
binary 
= 
null  
;  !
try 
{ 
string 
insertQuery "
=# $
$str% G
+H I
idJ L
+M N
$strO S
;S T
OdbcConnection 
conect %
=& '
cn( *
.* +
conexion+ 3
(3 4
)4 5
;5 6
OdbcCommand 
command #
=$ %
new& )
OdbcCommand* 5
(5 6
insertQuery6 A
,A B
conectC I
)I J
;J K
command 
. 
ExecuteNonQuery '
(' (
)( )
;) *
OdbcDataReader+ 9
	busquedac: C
;C D
	busquedac 
= 
command #
.# $
ExecuteReader$ 1
(1 2
)2 3
;3 4
if 
( 
! 
	busquedac 
. 
HasRows &
)& '
{ 
throw 
new 
	Exception '
(' (
$str( E
)E F
;F G
} 
if   
(   
	busquedac   
.   
Read   "
(  " #
)  # $
)  $ %
{!! 
binary"" 
="" 
("" 
byte"" "
[""" #
]""# $
)""$ %
	busquedac""% .
["". /
$str""/ ;
]""; <
;""< =
}## 
cn$$ 
.$$ 
desconexion$$ 
($$ 
conect$$ %
)$$% &
;$$& '
return%% 
binary%% 
;%% 
}&& 
catch'' 
('' 
	Exception'' 
ex'' 
)''  
{(( 

MessageBox)) 
.)) 
Show)) 
())  
$str))  8
+))9 :
ex)); =
)))= >
;))> ?
return** 
null** 
;** 
}++ 
},, 	
public.. 
void.. 
insertaNuevaFoto.. $
(..$ %
string..% +
id.., .
,... /
byte..0 4
[..4 5
]..5 6
foto..7 ;
)..; <
{// 	
try00 
{11 
string22 
insertQuery22 "
=22# $
$str22% A
+22B C
id22D F
+22G H
$str22I P
;22P Q
OdbcConnection33 
conect33 %
=33& '
cn33( *
.33* +
conexion33+ 3
(333 4
)334 5
;335 6
OdbcCommand44 
command44 #
=44$ %
new44& )
OdbcCommand44* 5
(445 6
insertQuery446 A
,44A B
conect44C I
)44I J
;44J K
OdbcParameter55 
prm55 !
=55" #
new55$ '
OdbcParameter55( 5
(555 6
$str556 <
,55< =
OdbcType55> F
.55F G
Binary55G M
,55M N
foto55O S
.55S T
Length55T Z
,55Z [
ParameterDirection55\ n
.55n o
Input55o t
,55t u
false55v {
,55{ |
$num55} ~
,55~ 
$num
55Ä Å
,
55Å Ç
null
55É á
,
55á à
DataRowVersion
55â ó
.
55ó ò
Current
55ò ü
,
55ü †
foto
55° •
)
55• ¶
;
55¶ ß
command66 
.66 

Parameters66 "
.66" #
Add66# &
(66& '
prm66' *
)66* +
;66+ ,
if88 
(88 
command88 
.88 
ExecuteNonQuery88 +
(88+ ,
)88, -
==88. 0
$num881 2
)882 3
{99 

MessageBox:: 
.:: 
Show:: #
(::# $
$str::$ 2
,::2 3
$str::4 ;
)::; <
;::< =
};; 
cn<< 
.<< 
desconexion<< 
(<< 
conect<< %
)<<% &
;<<& '
}== 
catch>> 
(>> 
	Exception>> 
ex>> 
)>>  
{?? 

MessageBox@@ 
.@@ 
Show@@ 
(@@  
$str@@  9
+@@: ;
ex@@< >
)@@> ?
;@@? @
}AA 
}BB 	
publicDD 
voidDD 
insertaFotoDD 
(DD  
stringDD  &
idDD' )
,DD) *
byteDD+ /
[DD/ 0
]DD0 1
fotoDD2 6
)DD6 7
{EE 	
tryFF 
{GG 
stringHH 
insertQueryHH "
=HH# $
$strHH% P
+HHQ R
idHHS U
+HHV W
$strHHX \
;HH\ ]
OdbcConnectionII 
conectII %
=II& '
cnII( *
.II* +
conexionII+ 3
(II3 4
)II4 5
;II5 6
OdbcCommandJJ 
commandJJ #
=JJ$ %
newJJ& )
OdbcCommandJJ* 5
(JJ5 6
insertQueryJJ6 A
,JJA B
conectJJC I
)JJI J
;JJJ K
OdbcParameterKK 
prmKK !
=KK" #
newKK$ '
OdbcParameterKK( 5
(KK5 6
$strKK6 <
,KK< =
OdbcTypeKK> F
.KKF G
BinaryKKG M
,KKM N
fotoKKO S
.KKS T
LengthKKT Z
,KKZ [
ParameterDirectionKK\ n
.KKn o
InputKKo t
,KKt u
falseKKv {
,KK{ |
$numKK} ~
,KK~ 
$num
KKÄ Å
,
KKÅ Ç
null
KKÉ á
,
KKá à
DataRowVersion
KKâ ó
.
KKó ò
Current
KKò ü
,
KKü †
foto
KK° •
)
KK• ¶
;
KK¶ ß
commandLL 
.LL 

ParametersLL "
.LL" #
AddLL# &
(LL& '
prmLL' *
)LL* +
;LL+ ,
ifNN 
(NN 
commandNN 
.NN 
ExecuteNonQueryNN +
(NN+ ,
)NN, -
==NN. 0
$numNN1 2
)NN2 3
{OO 

MessageBoxPP 
.PP 
ShowPP #
(PP# $
$strPP$ 2
,PP2 3
$strPP4 ;
)PP; <
;PP< =
}QQ 
cnRR 
.RR 
desconexionRR 
(RR 
conectRR %
)RR% &
;RR& '
}SS 
catchTT 
(TT 
	ExceptionTT 
exTT 
)TT  
{UU 

MessageBoxVV 
.VV 
ShowVV 
(VV  
$strVV  9
+VV: ;
exVV< >
)VV> ?
;VV? @
}WW 
}XX 	
publicYY 
intYY %
idSiguienteDeNuevoIngresoYY ,
(YY, -
stringYY- 3
tablaYY4 9
,YY9 :
stringYY; A
campoBYYB H
)YYH I
{ZZ 	
string[[ 
ultimoEntero[[ 
=[[  !
$str[[" $
;[[$ %
int[[& )
enteroSumado[[* 6
=[[7 8
$num[[9 :
;[[: ;
OdbcDataReader[[< J
leer[[K O
=[[P Q
null[[R V
;[[V W
string\\ 
sql\\ 
=\\ 
$str\\ !
+\\" #
$str\\$ '
+\\( )
$str\\* -
+\\. /
campoB\\0 6
+\\7 8
$str\\9 =
+\\> ?
$str\\@ C
+\\D E
$str\\F I
+\\J K
$str\\L P
+\\Q R
$str\\S V
+\\W X
campoB\\Y _
+\\` a
$str\\b e
+\\f g
$str\\h n
+\\o p
$str\\q t
+\\u v
tabla\\w |
+\\} ~
$str	\\ Ç
+
\\É Ñ
$str
\\Ö è
+
\\ê ë
$str
\\í ï
+
\\ñ ó
campoB
\\ò û
+
\\ü †
$str
\\° §
+
\\• ¶
$str
\\ß µ
;
\\µ ∂
OdbcConnection]] 
conect]] !
=]]" #
cn]]$ &
.]]& '
conexion]]' /
(]]/ 0
)]]0 1
;]]1 2
try^^ 
{__ 
OdbcCommand`` 
comando`` #
=``$ %
new``& )
OdbcCommand``* 5
(``5 6
sql``6 9
,``9 :
conect``; A
)``A B
;``B C
leeraa 
=aa 
comandoaa 
.aa 
ExecuteReaderaa ,
(aa, -
)aa- .
;aa. /
whilebb 
(bb 
leerbb 
.bb 
Readbb  
(bb  !
)bb! "
)bb" #
{cc 
ultimoEnterodd  
=dd! "
leerdd# '
.dd' (
	GetStringdd( 1
(dd1 2
$numdd2 3
)dd3 4
;dd4 5
enteroSumadoee  
=ee! "
intee# &
.ee& '
Parseee' ,
(ee, -
ultimoEnteroee- 9
)ee9 :
+ee; <
$numee= >
;ee> ?
}ff 
}gg 
catchhh 
(hh 
OdbcExceptionhh  
exhh! #
)hh# $
{ii 

MessageBoxii 
.ii 
Showii 
(ii 
$strii 9
+ii: ;
exii< >
.ii> ?
Messageii? F
)iiF G
;iiG H
}iiI J
finallyjj 
{kk 
cnkk 
.kk 
desconexionkk 
(kk 
conectkk #
)kk# $
;kk$ %
}kk& '
ifll 
(ll 
enteroSumadoll 
==ll 
$numll  !
)ll! "
{mm 
enteroSumadomm 
=mm 
$nummm 
;mm 
}mm  !
returnoo 
enteroSumadooo 
;oo  
}pp 	
publicrr 
intrr 
idEncabezadoActualrr %
(rr% &
stringrr& ,
tablarr- 2
,rr2 3
stringrr4 :
campoBrr; A
)rrA B
{ss 	
stringtt 
ultimoEnterott 
=tt  !
$strtt" $
;tt$ %
inttt& )
enteroSumadott* 6
=tt7 8
$numtt9 :
;tt: ;
OdbcDataReadertt< J
leerttK O
=ttP Q
nullttR V
;ttV W
stringuu 
sqluu 
=uu 
$struu #
+uu$ %
campoBuu& ,
+uu- .
$struu/ 3
+uu4 5
$struu6 >
+uu? @
campoBuuA G
+uuH I
$struuJ S
+uuT U
tablauuV [
+uu\ ]
$struu^ j
+uuk l
campoBuum s
+uut u
$str	uuv Ü
;
uuÜ á
OdbcConnectionvv 
conectvv !
=vv" #
cnvv$ &
.vv& '
conexionvv' /
(vv/ 0
)vv0 1
;vv1 2
tryww 
{xx 
OdbcCommandyy 
comandoyy #
=yy$ %
newyy& )
OdbcCommandyy* 5
(yy5 6
sqlyy6 9
,yy9 :
conectyy; A
)yyA B
;yyB C
leerzz 
=zz 
comandozz 
.zz 
ExecuteReaderzz ,
(zz, -
)zz- .
;zz. /
while{{ 
({{ 
leer{{ 
.{{ 
Read{{  
({{  !
){{! "
){{" #
{|| 
ultimoEntero}}  
=}}! "
leer}}# '
.}}' (
	GetString}}( 1
(}}1 2
$num}}2 3
)}}3 4
;}}4 5
enteroSumado~~  
=~~! "
int~~# &
.~~& '
Parse~~' ,
(~~, -
ultimoEntero~~- 9
)~~9 :
;~~: ;
} 
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
OdbcException
ÅÅ  
ex
ÅÅ! #
)
ÅÅ# $
{
ÇÇ 

MessageBox
ÇÇ 
.
ÇÇ 
Show
ÇÇ 
(
ÇÇ 
$str
ÇÇ 9
+
ÇÇ: ;
ex
ÇÇ< >
.
ÇÇ> ?
Message
ÇÇ? F
)
ÇÇF G
;
ÇÇG H
}
ÇÇI J
{
ÉÉ 
cn
ÉÉ 
.
ÉÉ 
desconexion
ÉÉ 
(
ÉÉ 
conect
ÉÉ #
)
ÉÉ# $
;
ÉÉ$ %
}
ÉÉ& '
return
ÑÑ 
enteroSumado
ÑÑ 
;
ÑÑ  
}
ÖÖ 	
public
ää 
	DataTable
ää *
llanarTblEmpleadoDisponibles
ää 5
(
ää5 6
string
ää6 <
dato
ää= A
)
ääA B
{
ãã 	
	DataTable
åå 
table
åå 
=
åå 
new
åå !
	DataTable
åå" +
(
åå+ ,
)
åå, -
;
åå- .
OdbcConnection
åå/ =
conect
åå> D
=
ååE F
cn
ååG I
.
ååI J
conexion
ååJ R
(
ååR S
)
ååS T
;
ååT U
try
çç 
{
éé 
string
êê 
sql
êê 
=
êê 
$strêê Æ
+êêØ ∞
datoêê± µ
+êê∂ ∑
$strêê∏ Ω
;êêΩ æ
OdbcDataAdapter
ëë 
	dataTable
ëë  )
=
ëë* +
new
ëë, /
OdbcDataAdapter
ëë0 ?
(
ëë? @
sql
ëë@ C
,
ëëC D
conect
ëëE K
)
ëëK L
;
ëëL M
	dataTable
íí 
.
íí 
Fill
íí 
(
íí 
table
íí $
)
íí$ %
;
íí% &
return
îî 
table
îî 
;
îî 
}
ïï 
catch
ññ 
(
ññ 
	Exception
ññ 
ex
ññ 
)
ññ  
{
óó 

MessageBox
òò 
.
òò 
Show
òò 
(
òò  
$str
òò  C
+
òòD E
ex
òòF H
)
òòH I
;
òòI J
return
ôô 
table
ôô 
;
ôô 
}
öö 
finally
õõ 
{
úú 
cn
ùù 
.
ùù 
desconexion
ùù 
(
ùù 
conect
ùù %
)
ùù% &
;
ùù& '
}
ûû 
}
üü 	
public
££ 
	DataTable
££ (
llanarTblEmpleadoAsignados
££ 3
(
££3 4
string
££4 :
tabla
££; @
,
££@ A
string
££B H
dato
££I M
)
££M N
{
§§ 	
	DataTable
•• 
table
•• 
=
•• 
new
•• !
	DataTable
••" +
(
••+ ,
)
••, -
;
••- .
OdbcConnection
••/ =
conect
••> D
=
••E F
cn
••G I
.
••I J
conexion
••J R
(
••R S
)
••S T
;
••T U
try
¶¶ 
{
ßß 
string
©© 
sql
©© 
=
©© 
$str
©© J
+
©©K L
tabla
©©M R
+
©©S T
$str©©U ì
+©©î ï
dato©©ñ ö
+©©õ ú
$str©©ù ∏
;©©∏ π
OdbcDataAdapter
™™ 
	dataTable
™™  )
=
™™* +
new
™™, /
OdbcDataAdapter
™™0 ?
(
™™? @
sql
™™@ C
,
™™C D
conect
™™E K
)
™™K L
;
™™L M
	dataTable
´´ 
.
´´ 
Fill
´´ 
(
´´ 
table
´´ $
)
´´$ %
;
´´% &
return
≠≠ 
table
≠≠ 
;
≠≠ 
}
ÆÆ 
catch
ØØ 
(
ØØ 
	Exception
ØØ 
ex
ØØ 
)
ØØ  
{
∞∞ 

MessageBox
±± 
.
±± 
Show
±± 
(
±±  
$str
±±  A
+
±±B C
ex
±±D F
)
±±F G
;
±±G H
return
≤≤ 
table
≤≤ 
;
≤≤ 
}
≥≥ 
finally
¥¥ 
{
µµ 
cn
∂∂ 
.
∂∂ 
desconexion
∂∂ 
(
∂∂ 
conect
∂∂ %
)
∂∂% &
;
∂∂& '
}
∑∑ 
}
∏∏ 	
public
ªª 
void
ªª 
AsignarEmpleados
ªª $
(
ªª$ %
string
ªª% +
tabla
ªª, 1
,
ªª1 2
string
ªª3 9
valor1
ªª: @
,
ªª@ A
string
ªªB H
valor2
ªªI O
)
ªªO P
{
ºº 	
OdbcConnection
ΩΩ 
conect
ΩΩ !
=
ΩΩ" #
cn
ΩΩ$ &
.
ΩΩ& '
conexion
ΩΩ' /
(
ΩΩ/ 0
)
ΩΩ0 1
;
ΩΩ1 2
try
ææ 
{
øø 
string
¿¿ 
sql
¿¿ 
=
¿¿ 
$str
¿¿ +
+
¿¿, -
tabla
¿¿. 3
+
¿¿4 5
$str
¿¿6 e
+
¿¿f g
valor1
¿¿h n
+
¿¿o p
$str
¿¿q w
+
¿¿x y
valor2¿¿z Ä
+¿¿Å Ç
$str¿¿É à
;¿¿à â
OdbcCommand
¡¡ 
consulta
¡¡ $
=
¡¡% &
new
¡¡' *
OdbcCommand
¡¡+ 6
(
¡¡6 7
sql
¡¡7 :
,
¡¡: ;
conect
¡¡< B
)
¡¡B C
;
¡¡C D
consulta
¬¬ 
.
¬¬ 
ExecuteNonQuery
¬¬ (
(
¬¬( )
)
¬¬) *
;
¬¬* +
}
ƒƒ 
catch
≈≈ 
(
≈≈ 
	Exception
≈≈ 
ex
≈≈ 
)
≈≈  
{
∆∆ 
}
»» 
finally
…… 
{
   
cn
ÀÀ 
.
ÀÀ 
desconexion
ÀÀ 
(
ÀÀ 
conect
ÀÀ %
)
ÀÀ% &
;
ÀÀ& '
}
ÃÃ 
}
ÕÕ 	
public
ŒŒ 
void
ŒŒ '
AsignarATodosLosEmpleados
ŒŒ -
(
ŒŒ- .
string
ŒŒ. 4
tabla
ŒŒ5 :
,
ŒŒ: ;
string
ŒŒ< B
valor
ŒŒC H
)
ŒŒH I
{
œœ 	
OdbcConnection
–– 
conect
–– !
=
––" #
cn
––$ &
.
––& '
conexion
––' /
(
––/ 0
)
––0 1
;
––1 2
try
—— 
{
““ 
string
”” 
sql
”” 
=
”” 
$str
”” +
+
””, -
tabla
””. 3
+
””4 5
$str
””6 U
+
””V W
valor
””X ]
+
””^ _
$str
””` d
;
””d e
OdbcCommand
‘‘ 
consulta
‘‘ $
=
‘‘% &
new
‘‘' *
OdbcCommand
‘‘+ 6
(
‘‘6 7
sql
‘‘7 :
,
‘‘: ;
conect
‘‘< B
)
‘‘B C
;
‘‘C D
consulta
’’ 
.
’’ 
ExecuteNonQuery
’’ (
(
’’( )
)
’’) *
;
’’* +
}
÷÷ 
catch
◊◊ 
(
◊◊ 
	Exception
◊◊ 
ex
◊◊ 
)
◊◊  
{
ÿÿ 
}
⁄⁄ 
finally
€€ 
{
‹‹ 
cn
›› 
.
›› 
desconexion
›› 
(
›› 
conect
›› %
)
››% &
;
››& '
}
ﬁﬁ 
}
ﬂﬂ 	
public
·· 
void
·· (
EliminarUnEmpleadoAsignado
·· .
(
··. /
string
··/ 5
tabla
··6 ;
,
··; <
string
··= C
valor1
··D J
,
··J K
string
··L R
valor2
··S Y
)
··Y Z
{
‚‚ 	
OdbcConnection
„„ 
conect
„„ !
=
„„" #
cn
„„$ &
.
„„& '
conexion
„„' /
(
„„/ 0
)
„„0 1
;
„„1 2
try
‰‰ 
{
ÂÂ 
string
ÊÊ 
sql
ÊÊ 
=
ÊÊ 
$str
ÊÊ +
+
ÊÊ, -
tabla
ÊÊ. 3
+
ÊÊ4 5
$str
ÊÊ6 U
+
ÊÊV W
valor1
ÊÊX ^
+
ÊÊ_ `
$str
ÊÊa w
+
ÊÊx y
valor2ÊÊz Ä
+ÊÊÅ Ç
$strÊÊÉ á
;ÊÊá à
OdbcCommand
ÁÁ 
consulta
ÁÁ $
=
ÁÁ% &
new
ÁÁ' *
OdbcCommand
ÁÁ+ 6
(
ÁÁ6 7
sql
ÁÁ7 :
,
ÁÁ: ;
conect
ÁÁ< B
)
ÁÁB C
;
ÁÁC D
consulta
ËË 
.
ËË 
ExecuteNonQuery
ËË (
(
ËË( )
)
ËË) *
;
ËË* +
}
ÈÈ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ 
ex
ÍÍ 
)
ÍÍ  
{
ÎÎ 

MessageBox
ÏÏ 
.
ÏÏ 
Show
ÏÏ 
(
ÏÏ  
$str
ÏÏ  <
)
ÏÏ< =
;
ÏÏ= >
}
ÌÌ 
finally
ÓÓ 
{
ÔÔ 
cn
 
.
 
desconexion
 
(
 
conect
 %
)
% &
;
& '
}
ÒÒ 
}
ÚÚ 	
public
ıı 
void
ıı 3
%EliminarTodasLasAsignacionesEmpleados
ıı 9
(
ıı9 :
string
ıı: @
tabla
ııA F
,
ııF G
string
ııH N
valor
ııO T
)
ııT U
{
ˆˆ 	
OdbcConnection
˜˜ 
conect
˜˜ !
=
˜˜" #
cn
˜˜$ &
.
˜˜& '
conexion
˜˜' /
(
˜˜/ 0
)
˜˜0 1
;
˜˜1 2
try
¯¯ 
{
˘˘ 
string
˙˙ 
sql
˙˙ 
=
˙˙ 
$str
˙˙ +
+
˙˙, -
tabla
˙˙. 3
+
˙˙4 5
$str
˙˙6 U
+
˙˙V W
valor
˙˙X ]
+
˙˙^ _
$str
˙˙` d
;
˙˙d e
OdbcCommand
˚˚ 
consulta
˚˚ $
=
˚˚% &
new
˚˚' *
OdbcCommand
˚˚+ 6
(
˚˚6 7
sql
˚˚7 :
,
˚˚: ;
conect
˚˚< B
)
˚˚B C
;
˚˚C D
consulta
¸¸ 
.
¸¸ 
ExecuteNonQuery
¸¸ (
(
¸¸( )
)
¸¸) *
;
¸¸* +
}
˝˝ 
catch
˛˛ 
(
˛˛ 
	Exception
˛˛ 
ex
˛˛ 
)
˛˛  
{
ˇˇ 

MessageBox
ÄÄ 
.
ÄÄ 
Show
ÄÄ 
(
ÄÄ  
$str
ÄÄ  <
)
ÄÄ< =
;
ÄÄ= >
}
ÅÅ 
finally
ÇÇ 
{
ÉÉ 
cn
ÑÑ 
.
ÑÑ 
desconexion
ÑÑ 
(
ÑÑ 
conect
ÑÑ %
)
ÑÑ% &
;
ÑÑ& '
}
ÖÖ 
}
ÜÜ 	
public
ää 
void
ää 
bloqueabotones
ää "
(
ää" #
string
ää# )
tipousuario
ää* 5
,
ää5 6
Button
ää7 =
btnIngresar
ää> I
,
ääI J
Button
ääK Q
	btnEditar
ääR [
,
ää[ \
Button
ää] c

btnGuardar
ääd n
,
ään o
Button
ääp v
btnCancelarääw Ç
,ääÇ É
ButtonääÑ ä
btnEliminarääã ñ
,ääñ ó
Buttonääò û
btnImprimirääü ™
,ää™ ´
Buttonää¨ ≤
btnActualizarää≥ ¿
,ää¿ ¡
Buttonää¬ »
btnAyudaää… —
,ää— “
Buttonää” Ÿ
btnSalirää⁄ ‚
)ää‚ „
{
ãã 	
if
åå 
(
åå 
tipousuario
åå 
==
åå 
$str
åå &
||
åå' )
tipousuario
åå* 5
==
åå6 8
$str
åå9 @
||
ååA C
tipousuario
ååD O
==
ååP R
$str
ååS Z
||
åå[ ]
tipousuario
åå^ i
==
ååj l
$str
ååm |
||
åå} 
tipousuarioååÄ ã
==ååå é
$strååè û
||ååü °
tipousuarioåå¢ ≠
==ååÆ ∞
$stråå± ¿
)åå¿ ¡
{
çç 
btnIngresar
éé 
.
éé 
Enabled
éé #
=
éé$ %
true
éé& *
;
éé* +
	btnEditar
èè 
.
èè 
Enabled
èè !
=
èè" #
true
èè$ (
;
èè( )

btnGuardar
êê 
.
êê 
Enabled
êê "
=
êê# $
true
êê% )
;
êê) *
btnCancelar
ëë 
.
ëë 
Enabled
ëë #
=
ëë$ %
true
ëë& *
;
ëë* +
btnEliminar
íí 
.
íí 
Enabled
íí #
=
íí$ %
true
íí& *
;
íí* +
btnImprimir
ìì 
.
ìì 
Enabled
ìì #
=
ìì$ %
true
ìì& *
;
ìì* +
btnActualizar
îî 
.
îî 
Enabled
îî %
=
îî& '
true
îî( ,
;
îî, -
btnAyuda
ïï 
.
ïï 
Enabled
ïï  
=
ïï! "
true
ïï# '
;
ïï' (
btnSalir
ññ 
.
ññ 
Enabled
ññ  
=
ññ! "
true
ññ# '
;
ññ' (
}
óó 
else
òò 
if
òò 
(
òò 
tipousuario
òò  
==
òò! #
$str
òò$ 0
||
òò1 3
tipousuario
òò4 ?
==
òò@ B
$str
òòC O
||
òòP R
tipousuario
òòS ^
==
òò_ a
$str
òòb n
)
òòn o
{
ôô 
btnIngresar
öö 
.
öö 
Enabled
öö #
=
öö$ %
false
öö& +
;
öö+ ,
	btnEditar
õõ 
.
õõ 
Enabled
õõ !
=
õõ" #
false
õõ$ )
;
õõ) *

btnGuardar
úú 
.
úú 
Enabled
úú "
=
úú# $
false
úú% *
;
úú* +
btnCancelar
ùù 
.
ùù 
Enabled
ùù #
=
ùù$ %
false
ùù& +
;
ùù+ ,
btnEliminar
ûû 
.
ûû 
Enabled
ûû #
=
ûû$ %
false
ûû& +
;
ûû+ ,
btnImprimir
üü 
.
üü 
Enabled
üü #
=
üü$ %
true
üü& *
;
üü* +
btnActualizar
†† 
.
†† 
Enabled
†† %
=
††& '
true
††( ,
;
††, -
btnAyuda
°° 
.
°° 
Enabled
°°  
=
°°! "
true
°°# '
;
°°' (
btnSalir
¢¢ 
.
¢¢ 
Enabled
¢¢  
=
¢¢! "
true
¢¢# '
;
¢¢' (
}
££ 
else
§§ 
if
§§ 
(
§§ 
tipousuario
§§  
==
§§! #
$str
§§$ /
||
§§0 2
tipousuario
§§3 >
==
§§? A
$str
§§B M
||
§§N P
tipousuario
§§Q \
==
§§] _
$str
§§` k
)
§§k l
{
•• 
btnIngresar
¶¶ 
.
¶¶ 
Enabled
¶¶ #
=
¶¶$ %
false
¶¶& +
;
¶¶+ ,
	btnEditar
ßß 
.
ßß 
Enabled
ßß !
=
ßß" #
false
ßß$ )
;
ßß) *

btnGuardar
®® 
.
®® 
Enabled
®® "
=
®®# $
false
®®% *
;
®®* +
btnCancelar
©© 
.
©© 
Enabled
©© #
=
©©$ %
false
©©& +
;
©©+ ,
btnEliminar
™™ 
.
™™ 
Enabled
™™ #
=
™™$ %
false
™™& +
;
™™+ ,
btnImprimir
´´ 
.
´´ 
Enabled
´´ #
=
´´$ %
true
´´& *
;
´´* +
btnActualizar
¨¨ 
.
¨¨ 
Enabled
¨¨ %
=
¨¨& '
false
¨¨( -
;
¨¨- .
btnAyuda
≠≠ 
.
≠≠ 
Enabled
≠≠  
=
≠≠! "
true
≠≠# '
;
≠≠' (
btnSalir
ÆÆ 
.
ÆÆ 
Enabled
ÆÆ  
=
ÆÆ! "
true
ÆÆ# '
;
ÆÆ' (
}
ØØ 
}
∞∞ 	
public
≤≤ 
void
≤≤ 
	LlenarCBX
≤≤ 
(
≤≤ 
ComboBox
≤≤ &
cbx
≤≤' *
,
≤≤* +
string
≤≤, 2
tabla
≤≤3 8
,
≤≤8 9
string
≤≤: @
campobuscado
≤≤A M
)
≤≤M N
{
≥≥ 	
string
¥¥ 
dato
¥¥ 
=
¥¥ 
$str
¥¥ 
;
¥¥ 
try
µµ 
{
∂∂ 
cbx
∑∑ 
.
∑∑ 
Items
∑∑ 
.
∑∑ 
Clear
∑∑ 
(
∑∑  
)
∑∑  !
;
∑∑! "
string
∏∏ 
insertQuery
∏∏ "
=
∏∏# $
$str
∏∏% 5
+
∏∏6 7
tabla
∏∏8 =
+
∏∏> ?
$str
∏∏@ V
;
∏∏V W
OdbcConnection
∫∫ 
conect
∫∫ %
=
∫∫& '
cn
∫∫( *
.
∫∫* +
conexion
∫∫+ 3
(
∫∫3 4
)
∫∫4 5
;
∫∫5 6
OdbcCommand
ªª 
command
ªª #
=
ªª$ %
new
ªª& )
OdbcCommand
ªª* 5
(
ªª5 6
insertQuery
ªª6 A
,
ªªA B
conect
ªªC I
)
ªªI J
;
ªªJ K
command
ºº 
.
ºº 
ExecuteNonQuery
ºº '
(
ºº' (
)
ºº( )
;
ºº) *
OdbcDataReader
ºº+ 9
	busquedac
ºº: C
;
ººC D
	busquedac
ΩΩ 
=
ΩΩ 
command
ΩΩ #
.
ΩΩ# $
ExecuteReader
ΩΩ$ 1
(
ΩΩ1 2
)
ΩΩ2 3
;
ΩΩ3 4
if
ææ 
(
ææ 
!
ææ 
	busquedac
ææ 
.
ææ 
HasRows
ææ &
)
ææ& '
{
øø 
}
¡¡ 
while
¬¬ 
(
¬¬ 
	busquedac
¬¬  
.
¬¬  !
Read
¬¬! %
(
¬¬% &
)
¬¬& '
)
¬¬' (
{
√√ 
dato
ƒƒ 
=
ƒƒ 
	busquedac
ƒƒ $
[
ƒƒ$ %
campobuscado
ƒƒ% 1
]
ƒƒ1 2
.
ƒƒ2 3
ToString
ƒƒ3 ;
(
ƒƒ; <
)
ƒƒ< =
;
ƒƒ= >
cbx
≈≈ 
.
≈≈ 
Items
≈≈ 
.
≈≈ 
Add
≈≈ !
(
≈≈! "
dato
≈≈" &
)
≈≈& '
;
≈≈' (
}
∆∆ 
cn
«« 
.
«« 
desconexion
«« 
(
«« 
conect
«« %
)
««% &
;
««& '
}
»» 
catch
…… 
(
…… 
	Exception
…… 
ex
…… 
)
……  
{
   
}
ÀÀ 
}
ÃÃ 	
public
ŒŒ 
	DataTable
ŒŒ 
ActualizaDetalles
ŒŒ *
(
ŒŒ* +
string
ŒŒ+ 1
tabla
ŒŒ2 7
,
ŒŒ7 8
string
ŒŒ9 ?

cotizacion
ŒŒ@ J
)
ŒŒJ K
{
œœ 	
Conexion
–– 
cn
–– 
=
–– 
new
–– 
Conexion
–– &
(
––& '
)
––' (
;
––( )
string
—— 
sql
—— 
=
—— 
$str
—— )
+
——* +
tabla
——, 1
+
——2 3
$str
——4 N
+
——O P

cotizacion
——Q [
+
——\ ]
$str
——^ p
;
——p q
OdbcConnection
““ 
conn
““ 
=
““  !
cn
““" $
.
““$ %
conexion
““% -
(
““- .
)
““. /
;
““/ 0
OdbcDataAdapter
”” 
	dataTable
”” %
=
””& '
new
””( +
OdbcDataAdapter
””, ;
(
””; <
sql
””< ?
,
””? @
conn
””A E
)
””E F
;
””F G
cn
‘‘ 
.
‘‘ 
desconexion
‘‘ 
(
‘‘ 
conn
‘‘ 
)
‘‘  
;
‘‘  !
	DataTable
◊◊ 
table
◊◊ 
=
◊◊ 
new
◊◊ !
	DataTable
◊◊" +
(
◊◊+ ,
)
◊◊, -
;
◊◊- .
	dataTable
ÿÿ 
.
ÿÿ 
Fill
ÿÿ 
(
ÿÿ 
table
ÿÿ  
)
ÿÿ  !
;
ÿÿ! "
return
ŸŸ 
table
ŸŸ 
;
ŸŸ 
}
⁄⁄ 	
public
‹‹ 
	DataTable
‹‹ 
ActualizarDGV
‹‹ &
(
‹‹& '
string
‹‹' -
tabla
‹‹. 3
)
‹‹3 4
{
›› 	
Conexion
ﬁﬁ 
cn
ﬁﬁ 
=
ﬁﬁ 
new
ﬁﬁ 
Conexion
ﬁﬁ &
(
ﬁﬁ& '
)
ﬁﬁ' (
;
ﬁﬁ( )
string
ﬂﬂ 
sql
ﬂﬂ 
=
ﬂﬂ 
$str
ﬂﬂ )
+
ﬂﬂ* +
tabla
ﬂﬂ, 1
+
ﬂﬂ2 3
$str
ﬂﬂ4 7
+
ﬂﬂ8 9
$str
ﬂﬂ: J
;
ﬂﬂJ K
OdbcConnection
‡‡ 
conn
‡‡ 
=
‡‡  !
cn
‡‡" $
.
‡‡$ %
conexion
‡‡% -
(
‡‡- .
)
‡‡. /
;
‡‡/ 0
OdbcDataAdapter
·· 
	dataTable
·· %
=
··& '
new
··( +
OdbcDataAdapter
··, ;
(
··; <
sql
··< ?
,
··? @
conn
··A E
)
··E F
;
··F G
cn
‚‚ 
.
‚‚ 
desconexion
‚‚ 
(
‚‚ 
conn
‚‚ 
)
‚‚  
;
‚‚  !
	DataTable
ÂÂ 
table
ÂÂ 
=
ÂÂ 
new
ÂÂ !
	DataTable
ÂÂ" +
(
ÂÂ+ ,
)
ÂÂ, -
;
ÂÂ- .
	dataTable
ÊÊ 
.
ÊÊ 
Fill
ÊÊ 
(
ÊÊ 
table
ÊÊ  
)
ÊÊ  !
;
ÊÊ! "
return
ÁÁ 
table
ÁÁ 
;
ÁÁ 
}
ËË 	
public
ÍÍ 
void
ÍÍ 
convertirFechaDTP
ÍÍ %
(
ÍÍ% &
DateTimePicker
ÍÍ& 4
dtp
ÍÍ5 8
,
ÍÍ8 9
TextBox
ÍÍ: A
txt
ÍÍB E
)
ÍÍE F
{
ÎÎ 	
DateTime
ÏÏ 
date
ÏÏ 
=
ÏÏ 
new
ÏÏ 
DateTime
ÏÏ  (
(
ÏÏ( )
)
ÏÏ) *
;
ÏÏ* +
date
ÓÓ 
=
ÓÓ 
dtp
ÓÓ 
.
ÓÓ 
Value
ÓÓ 
;
ÓÓ 
string
ÔÔ 
fecha
ÔÔ 
=
ÔÔ 
dtp
ÔÔ 
.
ÔÔ 
Value
ÔÔ $
.
ÔÔ$ %
ToString
ÔÔ% -
(
ÔÔ- .
$str
ÔÔ. :
)
ÔÔ: ;
;
ÔÔ; <
txt
 
.
 
Text
 
=
 
fecha
 
;
 
}
ÒÒ 	
public
ÛÛ 
void
ÛÛ !
convertirFechaMySQL
ÛÛ '
(
ÛÛ' (
DateTimePicker
ÛÛ( 6
dtp
ÛÛ7 :
,
ÛÛ: ;
TextBox
ÛÛ< C
txt
ÛÛD G
)
ÛÛG H
{
ÙÙ 	
DateTime
ıı 
fecha
ıı 
=
ıı 
new
ıı  
DateTime
ıı! )
(
ıı) *
)
ıı* +
;
ıı+ ,
fecha
ˆˆ 
=
ˆˆ 
Convert
ˆˆ 
.
ˆˆ 

ToDateTime
ˆˆ &
(
ˆˆ& '
txt
ˆˆ' *
.
ˆˆ* +
Text
ˆˆ+ /
)
ˆˆ/ 0
;
ˆˆ0 1
dtp
˜˜ 
.
˜˜ 
Value
˜˜ 
=
˜˜ 
fecha
˜˜ 
.
˜˜ 
Date
˜˜ "
;
˜˜" #
}
¯¯ 	
public
˙˙ 
void
˙˙ 
IDcombo
˙˙ 
(
˙˙ 
TextBox
˙˙ #
textbox
˙˙$ +
,
˙˙+ ,
string
˙˙- 3
tabla
˙˙4 9
,
˙˙9 :
string
˙˙; A
campobuscado
˙˙B N
,
˙˙N O
string
˙˙P V
nombre
˙˙W ]
)
˙˙] ^
{
˚˚ 	
string
¸¸ 
dato
¸¸ 
=
¸¸ 
$str
¸¸ 
;
¸¸ 
try
˝˝ 
{
˛˛ 
textbox
ˇˇ 
.
ˇˇ 
Text
ˇˇ 
=
ˇˇ 
$str
ˇˇ !
;
ˇˇ! "
string
ÄÄ 
insertQuery
ÄÄ "
=
ÄÄ# $
$str
ÄÄ% 5
+
ÄÄ6 7
tabla
ÄÄ8 =
+
ÄÄ> ?
$str
ÄÄ@ d
+
ÄÄe f
nombre
ÄÄg m
+
ÄÄn o
$str
ÄÄp t
;
ÄÄt u
OdbcConnection
ÇÇ 
conect
ÇÇ %
=
ÇÇ& '
cn
ÇÇ( *
.
ÇÇ* +
conexion
ÇÇ+ 3
(
ÇÇ3 4
)
ÇÇ4 5
;
ÇÇ5 6
OdbcCommand
ÉÉ 
command
ÉÉ #
=
ÉÉ$ %
new
ÉÉ& )
OdbcCommand
ÉÉ* 5
(
ÉÉ5 6
insertQuery
ÉÉ6 A
,
ÉÉA B
conect
ÉÉC I
)
ÉÉI J
;
ÉÉJ K
command
ÑÑ 
.
ÑÑ 
ExecuteNonQuery
ÑÑ '
(
ÑÑ' (
)
ÑÑ( )
;
ÑÑ) *
OdbcDataReader
ÑÑ+ 9
	busquedac
ÑÑ: C
;
ÑÑC D
	busquedac
ÖÖ 
=
ÖÖ 
command
ÖÖ #
.
ÖÖ# $
ExecuteReader
ÖÖ$ 1
(
ÖÖ1 2
)
ÖÖ2 3
;
ÖÖ3 4
if
ÜÜ 
(
ÜÜ 
!
ÜÜ 
	busquedac
ÜÜ 
.
ÜÜ 
HasRows
ÜÜ &
)
ÜÜ& '
{
áá 
}
ââ 
while
ää 
(
ää 
	busquedac
ää  
.
ää  !
Read
ää! %
(
ää% &
)
ää& '
)
ää' (
{
ãã 
dato
åå 
=
åå 
	busquedac
åå $
[
åå$ %
campobuscado
åå% 1
]
åå1 2
.
åå2 3
ToString
åå3 ;
(
åå; <
)
åå< =
;
åå= >
textbox
çç 
.
çç 
Text
çç  
=
çç! "
dato
çç# '
;
çç' (
}
éé 
cn
èè 
.
èè 
desconexion
èè 
(
èè 
conect
èè %
)
èè% &
;
èè& '
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë 
ex
ëë 
)
ëë  
{
íí 
}
ìì 
}
îî 	
public
ññ 
void
ññ 
LlenarCBXProducto
ññ %
(
ññ% &
ComboBox
ññ& .
cbx
ññ/ 2
,
ññ2 3
string
ññ4 :
tabla
ññ; @
,
ññ@ A
string
ññB H
campobuscado
ññI U
,
ññU V
string
ññW ]

inventario
ññ^ h
)
ññh i
{
óó 	
string
òò 
dato
òò 
=
òò 
$str
òò 
;
òò 
try
ôô 
{
öö 
cbx
õõ 
.
õõ 
Items
õõ 
.
õõ 
Clear
õõ 
(
õõ  
)
õõ  !
;
õõ! "
string
úú 
insertQuery
úú "
=
úú# $
$str
úú% 5
+
úú6 7
tabla
úú8 =
+
úú> ?
$str
úú@ k
+
úúl m

inventario
úún x
+
úúy z
$str
úú{ 
;úú Ä
OdbcConnection
ûû 
conect
ûû %
=
ûû& '
cn
ûû( *
.
ûû* +
conexion
ûû+ 3
(
ûû3 4
)
ûû4 5
;
ûû5 6
OdbcCommand
üü 
command
üü #
=
üü$ %
new
üü& )
OdbcCommand
üü* 5
(
üü5 6
insertQuery
üü6 A
,
üüA B
conect
üüC I
)
üüI J
;
üüJ K
command
†† 
.
†† 
ExecuteNonQuery
†† '
(
††' (
)
††( )
;
††) *
OdbcDataReader
††+ 9
	busquedac
††: C
;
††C D
	busquedac
°° 
=
°° 
command
°° #
.
°°# $
ExecuteReader
°°$ 1
(
°°1 2
)
°°2 3
;
°°3 4
if
¢¢ 
(
¢¢ 
!
¢¢ 
	busquedac
¢¢ 
.
¢¢ 
HasRows
¢¢ &
)
¢¢& '
{
££ 
}
•• 
while
¶¶ 
(
¶¶ 
	busquedac
¶¶  
.
¶¶  !
Read
¶¶! %
(
¶¶% &
)
¶¶& '
)
¶¶' (
{
ßß 
dato
®® 
=
®® 
	busquedac
®® $
[
®®$ %
campobuscado
®®% 1
]
®®1 2
.
®®2 3
ToString
®®3 ;
(
®®; <
)
®®< =
;
®®= >
cbx
©© 
.
©© 
Items
©© 
.
©© 
Add
©© !
(
©©! "
dato
©©" &
)
©©& '
;
©©' (
}
™™ 
cn
´´ 
.
´´ 
desconexion
´´ 
(
´´ 
conect
´´ %
)
´´% &
;
´´& '
}
¨¨ 
catch
≠≠ 
(
≠≠ 
	Exception
≠≠ 
ex
≠≠ 
)
≠≠  
{
ÆÆ 
}
ØØ 
}
∞∞ 	
public
≤≤ 
void
≤≤ 
NombreID
≤≤ 
(
≤≤ 
ComboBox
≤≤ %
combo
≤≤& +
,
≤≤+ ,
string
≤≤- 3
tabla
≤≤4 9
,
≤≤9 :
string
≤≤; A
campobuscado
≤≤B N
,
≤≤N O
string
≤≤P V
pkid
≤≤W [
)
≤≤[ \
{
≥≥ 	
string
¥¥ 
dato
¥¥ 
=
¥¥ 
$str
¥¥ 
;
¥¥ 
try
µµ 
{
∂∂ 
string
∏∏ 
insertQuery
∏∏ "
=
∏∏# $
$str
∏∏% 5
+
∏∏6 7
tabla
∏∏8 =
+
∏∏> ?
$str
∏∏@ b
+
∏∏c d
pkid
∏∏e i
+
∏∏j k
$str
∏∏l p
;
∏∏p q
OdbcConnection
∫∫ 
conect
∫∫ %
=
∫∫& '
cn
∫∫( *
.
∫∫* +
conexion
∫∫+ 3
(
∫∫3 4
)
∫∫4 5
;
∫∫5 6
OdbcCommand
ªª 
command
ªª #
=
ªª$ %
new
ªª& )
OdbcCommand
ªª* 5
(
ªª5 6
insertQuery
ªª6 A
,
ªªA B
conect
ªªC I
)
ªªI J
;
ªªJ K
command
ºº 
.
ºº 
ExecuteNonQuery
ºº '
(
ºº' (
)
ºº( )
;
ºº) *
OdbcDataReader
ºº+ 9
	busquedac
ºº: C
;
ººC D
	busquedac
ΩΩ 
=
ΩΩ 
command
ΩΩ #
.
ΩΩ# $
ExecuteReader
ΩΩ$ 1
(
ΩΩ1 2
)
ΩΩ2 3
;
ΩΩ3 4
if
ææ 
(
ææ 
!
ææ 
	busquedac
ææ 
.
ææ 
HasRows
ææ &
)
ææ& '
{
øø 
}
¡¡ 
while
¬¬ 
(
¬¬ 
	busquedac
¬¬  
.
¬¬  !
Read
¬¬! %
(
¬¬% &
)
¬¬& '
)
¬¬' (
{
√√ 
dato
ƒƒ 
=
ƒƒ 
	busquedac
ƒƒ $
[
ƒƒ$ %
campobuscado
ƒƒ% 1
]
ƒƒ1 2
.
ƒƒ2 3
ToString
ƒƒ3 ;
(
ƒƒ; <
)
ƒƒ< =
;
ƒƒ= >
combo
≈≈ 
.
≈≈ 
SelectedItem
≈≈ &
=
≈≈' (
dato
≈≈) -
;
≈≈- .
}
∆∆ 
cn
«« 
.
«« 
desconexion
«« 
(
«« 
conect
«« %
)
««% &
;
««& '
}
»» 
catch
…… 
(
…… 
	Exception
…… 
ex
…… 
)
……  
{
   
}
ÀÀ 
}
ÃÃ 	
public
ŒŒ 
void
ŒŒ 

IDProducto
ŒŒ 
(
ŒŒ 
TextBox
ŒŒ &
textbox
ŒŒ' .
,
ŒŒ. /
string
ŒŒ0 6
tabla
ŒŒ7 <
,
ŒŒ< =
string
ŒŒ> D
campobuscado
ŒŒE Q
,
ŒŒQ R
string
ŒŒS Y
nombre
ŒŒZ `
,
ŒŒ` a
string
ŒŒb h

inventario
ŒŒi s
)
ŒŒs t
{
œœ 	
string
–– 
dato
–– 
=
–– 
$str
–– 
;
–– 
try
—— 
{
““ 
textbox
”” 
.
”” 
Text
”” 
=
”” 
$str
”” !
;
””! "
string
‘‘ 
insertQuery
‘‘ "
=
‘‘# $
$str
‘‘% 5
+
‘‘6 7
tabla
‘‘8 =
+
‘‘> ?
$str
‘‘@ d
+
‘‘e f
nombre
‘‘g m
+
‘‘n o
$str‘‘p â
+‘‘ä ã

inventario‘‘å ñ
+‘‘ó ò
$str‘‘ô ù
;‘‘ù û
OdbcConnection
÷÷ 
conect
÷÷ %
=
÷÷& '
cn
÷÷( *
.
÷÷* +
conexion
÷÷+ 3
(
÷÷3 4
)
÷÷4 5
;
÷÷5 6
OdbcCommand
◊◊ 
command
◊◊ #
=
◊◊$ %
new
◊◊& )
OdbcCommand
◊◊* 5
(
◊◊5 6
insertQuery
◊◊6 A
,
◊◊A B
conect
◊◊C I
)
◊◊I J
;
◊◊J K
command
ÿÿ 
.
ÿÿ 
ExecuteNonQuery
ÿÿ '
(
ÿÿ' (
)
ÿÿ( )
;
ÿÿ) *
OdbcDataReader
ÿÿ+ 9
	busquedac
ÿÿ: C
;
ÿÿC D
	busquedac
ŸŸ 
=
ŸŸ 
command
ŸŸ #
.
ŸŸ# $
ExecuteReader
ŸŸ$ 1
(
ŸŸ1 2
)
ŸŸ2 3
;
ŸŸ3 4
if
⁄⁄ 
(
⁄⁄ 
!
⁄⁄ 
	busquedac
⁄⁄ 
.
⁄⁄ 
HasRows
⁄⁄ &
)
⁄⁄& '
{
€€ 
}
›› 
while
ﬁﬁ 
(
ﬁﬁ 
	busquedac
ﬁﬁ  
.
ﬁﬁ  !
Read
ﬁﬁ! %
(
ﬁﬁ% &
)
ﬁﬁ& '
)
ﬁﬁ' (
{
ﬂﬂ 
dato
‡‡ 
=
‡‡ 
	busquedac
‡‡ $
[
‡‡$ %
campobuscado
‡‡% 1
]
‡‡1 2
.
‡‡2 3
ToString
‡‡3 ;
(
‡‡; <
)
‡‡< =
;
‡‡= >
textbox
·· 
.
·· 
Text
··  
=
··! "
dato
··# '
;
··' (
}
‚‚ 
cn
„„ 
.
„„ 
desconexion
„„ 
(
„„ 
conect
„„ %
)
„„% &
;
„„& '
}
‰‰ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÊÊ 
}
ÁÁ 
}
ËË 	
public
ÍÍ 
string
ÍÍ 
	BuscaDato
ÍÍ 
(
ÍÍ  
string
ÍÍ  &
tabla
ÍÍ' ,
,
ÍÍ, -
string
ÍÍ. 4
campo
ÍÍ5 :
,
ÍÍ: ;
string
ÍÍ< B
campobuscado
ÍÍC O
,
ÍÍO P
string
ÍÍQ W
datoreferencia
ÍÍX f
)
ÍÍf g
{
ÎÎ 	
string
ÏÏ 
dato
ÏÏ 
=
ÏÏ 
$str
ÏÏ 
;
ÏÏ 
try
ÌÌ 
{
ÓÓ 
string
ÔÔ 
insertQuery
ÔÔ "
=
ÔÔ# $
$str
ÔÔ% 5
+
ÔÔ6 7
tabla
ÔÔ8 =
+
ÔÔ> ?
$str
ÔÔ@ I
+
ÔÔJ K
campobuscado
ÔÔL X
+
ÔÔY Z
$str
ÔÔ[ a
+
ÔÔb c
datoreferencia
ÔÔd r
+
ÔÔs t
$str
ÔÔu y
;
ÔÔy z
OdbcConnection
ÒÒ 
conect
ÒÒ %
=
ÒÒ& '
cn
ÒÒ( *
.
ÒÒ* +
conexion
ÒÒ+ 3
(
ÒÒ3 4
)
ÒÒ4 5
;
ÒÒ5 6
OdbcCommand
ÚÚ 
command
ÚÚ #
=
ÚÚ$ %
new
ÚÚ& )
OdbcCommand
ÚÚ* 5
(
ÚÚ5 6
insertQuery
ÚÚ6 A
,
ÚÚA B
conect
ÚÚC I
)
ÚÚI J
;
ÚÚJ K
command
ÛÛ 
.
ÛÛ 
ExecuteNonQuery
ÛÛ '
(
ÛÛ' (
)
ÛÛ( )
;
ÛÛ) *
OdbcDataReader
ÛÛ+ 9
	busquedac
ÛÛ: C
;
ÛÛC D
	busquedac
ÙÙ 
=
ÙÙ 
command
ÙÙ #
.
ÙÙ# $
ExecuteReader
ÙÙ$ 1
(
ÙÙ1 2
)
ÙÙ2 3
;
ÙÙ3 4
if
ıı 
(
ıı 
!
ıı 
	busquedac
ıı 
.
ıı 
HasRows
ıı &
)
ıı& '
{
ˆˆ 
}
¯¯ 
if
˘˘ 
(
˘˘ 
	busquedac
˘˘ 
.
˘˘ 
Read
˘˘ "
(
˘˘" #
)
˘˘# $
)
˘˘$ %
{
˙˙ 
dato
˚˚ 
=
˚˚ 
	busquedac
˚˚ $
[
˚˚$ %
campo
˚˚% *
]
˚˚* +
.
˚˚+ ,
ToString
˚˚, 4
(
˚˚4 5
)
˚˚5 6
;
˚˚6 7
}
¸¸ 
cn
˝˝ 
.
˝˝ 
desconexion
˝˝ 
(
˝˝ 
conect
˝˝ %
)
˝˝% &
;
˝˝& '
return
˛˛ 
dato
˛˛ 
;
˛˛ 
}
ˇˇ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ 
ex
ÄÄ 
)
ÄÄ  
{
ÅÅ 
return
ÇÇ 
dato
ÇÇ 
;
ÇÇ 
}
ÉÉ 
}
ÑÑ 	
public
ÜÜ 
void
ÜÜ 
NombreIDProducto
ÜÜ $
(
ÜÜ$ %
ComboBox
ÜÜ% -
combo
ÜÜ. 3
,
ÜÜ3 4
string
ÜÜ5 ;
tabla
ÜÜ< A
,
ÜÜA B
string
ÜÜC I
campobuscado
ÜÜJ V
,
ÜÜV W
string
ÜÜX ^
pkid
ÜÜ_ c
,
ÜÜc d
string
ÜÜe k

inventario
ÜÜl v
)
ÜÜv w
{
áá 	
string
àà 
dato
àà 
=
àà 
$str
àà 
;
àà 
try
ââ 
{
ää 
string
åå 
insertQuery
åå "
=
åå# $
$str
åå% 5
+
åå6 7
tabla
åå8 =
+
åå> ?
$str
åå@ b
+
ååc d
pkid
ååe i
+
ååj k
$stråål Ö
+ååÜ á

inventarioååà í
+ååì î
$strååï ô
;ååô ö
OdbcConnection
éé 
conect
éé %
=
éé& '
cn
éé( *
.
éé* +
conexion
éé+ 3
(
éé3 4
)
éé4 5
;
éé5 6
OdbcCommand
èè 
command
èè #
=
èè$ %
new
èè& )
OdbcCommand
èè* 5
(
èè5 6
insertQuery
èè6 A
,
èèA B
conect
èèC I
)
èèI J
;
èèJ K
command
êê 
.
êê 
ExecuteNonQuery
êê '
(
êê' (
)
êê( )
;
êê) *
OdbcDataReader
êê+ 9
	busquedac
êê: C
;
êêC D
	busquedac
ëë 
=
ëë 
command
ëë #
.
ëë# $
ExecuteReader
ëë$ 1
(
ëë1 2
)
ëë2 3
;
ëë3 4
if
íí 
(
íí 
!
íí 
	busquedac
íí 
.
íí 
HasRows
íí &
)
íí& '
{
ìì 
}
ïï 
while
ññ 
(
ññ 
	busquedac
ññ  
.
ññ  !
Read
ññ! %
(
ññ% &
)
ññ& '
)
ññ' (
{
óó 
dato
òò 
=
òò 
	busquedac
òò $
[
òò$ %
campobuscado
òò% 1
]
òò1 2
.
òò2 3
ToString
òò3 ;
(
òò; <
)
òò< =
;
òò= >
combo
ôô 
.
ôô 
SelectedItem
ôô &
=
ôô' (
dato
ôô) -
;
ôô- .
}
öö 
cn
õõ 
.
õõ 
desconexion
õõ 
(
õõ 
conect
õõ %
)
õõ% &
;
õõ& '
}
úú 
catch
ùù 
(
ùù 
	Exception
ùù 
ex
ùù 
)
ùù  
{
ûû 
}
üü 
}
†† 	
public
¢¢ 
void
¢¢ 
metodoInsertar
¢¢ "
(
¢¢" #
string
¢¢# )
query
¢¢* /
)
¢¢/ 0
{
££ 	
int
§§ 
ret
§§ 
;
§§ 
try
•• 
{
¶¶ 
OdbcCommand
®® 
consulta
®® $
=
®®% &
new
®®' *
OdbcCommand
®®+ 6
(
®®6 7
query
®®7 <
,
®®< =
cn
®®> @
.
®®@ A
conexion
®®A I
(
®®I J
)
®®J K
)
®®K L
;
®®L M
consulta
©© 
.
©© 
ExecuteNonQuery
©© (
(
©©( )
)
©©) *
;
©©* +
ret
™™ 
=
™™ 
$num
™™ 
;
™™ 
}
¨¨ 
catch
ÆÆ 
(
ÆÆ 
OdbcException
ÆÆ  
ex
ÆÆ! #
)
ÆÆ# $
{
ØØ 
ret
±± 
=
±± 
$num
±± 
;
±± 
}
≤≤ 
}
≥≥ 	
public
¥¥ 
void
¥¥ 
metodoModificar
¥¥ #
(
¥¥# $
string
¥¥$ *
query
¥¥+ 0
)
¥¥0 1
{
µµ 	
int
∂∂ 
ret
∂∂ 
;
∂∂ 
try
∑∑ 
{
∏∏ 
OdbcCommand
∫∫ 
consulta
∫∫ $
=
∫∫% &
new
∫∫' *
OdbcCommand
∫∫+ 6
(
∫∫6 7
query
∫∫7 <
,
∫∫< =
cn
∫∫> @
.
∫∫@ A
conexion
∫∫A I
(
∫∫I J
)
∫∫J K
)
∫∫K L
;
∫∫L M
consulta
ªª 
.
ªª 
ExecuteNonQuery
ªª (
(
ªª( )
)
ªª) *
;
ªª* +
ret
ºº 
=
ºº 
$num
ºº 
;
ºº 
}
ææ 
catch
¿¿ 
(
¿¿ 
OdbcException
¿¿  
ex
¿¿! #
)
¿¿# $
{
¡¡ 
ret
√√ 
=
√√ 
$num
√√ 
;
√√ 
}
ƒƒ 
}
≈≈ 	
public
«« 
void
«« 
metodoDarBaja
«« !
(
««! "
string
««" (
query
««) .
)
««. /
{
»» 	
int
…… 
ret
…… 
;
…… 
try
   
{
ÀÀ 
OdbcCommand
ÕÕ 
consulta
ÕÕ $
=
ÕÕ% &
new
ÕÕ' *
OdbcCommand
ÕÕ+ 6
(
ÕÕ6 7
query
ÕÕ7 <
,
ÕÕ< =
cn
ÕÕ> @
.
ÕÕ@ A
conexion
ÕÕA I
(
ÕÕI J
)
ÕÕJ K
)
ÕÕK L
;
ÕÕL M
consulta
ŒŒ 
.
ŒŒ 
ExecuteNonQuery
ŒŒ (
(
ŒŒ( )
)
ŒŒ) *
;
ŒŒ* +
ret
œœ 
=
œœ 
$num
œœ 
;
œœ 
}
—— 
catch
”” 
(
”” 
OdbcException
””  
ex
””! #
)
””# $
{
‘‘ 
ret
÷÷ 
=
÷÷ 
$num
÷÷ 
;
÷÷ 
}
◊◊ 
}
ÿÿ 	
public
ŸŸ 
void
ŸŸ 
metodoEliminar
ŸŸ "
(
ŸŸ" #
string
ŸŸ# )
query
ŸŸ* /
)
ŸŸ/ 0
{
⁄⁄ 	
int
€€ 
ret
€€ 
;
€€ 
try
‹‹ 
{
›› 
OdbcCommand
ﬂﬂ 
consulta
ﬂﬂ $
=
ﬂﬂ% &
new
ﬂﬂ' *
OdbcCommand
ﬂﬂ+ 6
(
ﬂﬂ6 7
query
ﬂﬂ7 <
,
ﬂﬂ< =
cn
ﬂﬂ> @
.
ﬂﬂ@ A
conexion
ﬂﬂA I
(
ﬂﬂI J
)
ﬂﬂJ K
)
ﬂﬂK L
;
ﬂﬂL M
consulta
‡‡ 
.
‡‡ 
ExecuteNonQuery
‡‡ (
(
‡‡( )
)
‡‡) *
;
‡‡* +
ret
·· 
=
·· 
$num
·· 
;
·· 
}
‚‚ 
catch
‰‰ 
(
‰‰ 
OdbcException
‰‰  
ex
‰‰! #
)
‰‰# $
{
ÂÂ 
ret
ÁÁ 
=
ÁÁ 
$num
ÁÁ 
;
ÁÁ 
}
ËË 
}
ÈÈ 	
public
ÎÎ 
	DataTable
ÎÎ 
ObtenerDetalles
ÎÎ (
(
ÎÎ( )
string
ÎÎ) /

cotizacion
ÎÎ0 :
,
ÎÎ: ;
string
ÎÎ< B
total
ÎÎC H
)
ÎÎH I
{
ÏÏ 	
Conexion
ÌÌ 
cn
ÌÌ 
=
ÌÌ 
new
ÌÌ 
Conexion
ÌÌ &
(
ÌÌ& '
)
ÌÌ' (
;
ÌÌ( )
string
ÓÓ 
sql
ÓÓ 
=
ÓÓ 
$strÓÓ §
+ÓÓ• ¶

cotizacionÓÓß ±
+ÓÓ≤ ≥
$strÓÓ¥ ∏
;ÓÓ∏ π
OdbcConnection
ÔÔ 
conn
ÔÔ 
=
ÔÔ  !
cn
ÔÔ" $
.
ÔÔ$ %
conexion
ÔÔ% -
(
ÔÔ- .
)
ÔÔ. /
;
ÔÔ/ 0
OdbcDataAdapter
 
	dataTable
 %
=
& '
new
( +
OdbcDataAdapter
, ;
(
; <
sql
< ?
,
? @
conn
A E
)
E F
;
F G
cn
ÒÒ 
.
ÒÒ 
desconexion
ÒÒ 
(
ÒÒ 
conn
ÒÒ 
)
ÒÒ  
;
ÒÒ  !
	DataTable
ÙÙ 
table
ÙÙ 
=
ÙÙ 
new
ÙÙ !
	DataTable
ÙÙ" +
(
ÙÙ+ ,
)
ÙÙ, -
;
ÙÙ- .
	dataTable
ıı 
.
ıı 
Fill
ıı 
(
ıı 
table
ıı  
)
ıı  !
;
ıı! "
return
˜˜ 
table
˜˜ 
;
˜˜ 
}
¯¯ 	
public
¸¸ 
void
¸¸ 
bloqueareporte
¸¸ "
(
¸¸" #
string
¸¸# )
tipousuario
¸¸* 5
,
¸¸5 6
Button
¸¸7 =
reporte
¸¸> E
)
¸¸E F
{
˝˝ 	
if
˛˛ 
(
˛˛ 
tipousuario
˛˛ 
==
˛˛ 
$str
˛˛ &
||
˛˛' )
tipousuario
˛˛* 5
==
˛˛6 8
$str
˛˛9 @
||
˛˛A C
tipousuario
˛˛D O
==
˛˛P R
$str
˛˛S Z
||
˛˛[ ]
tipousuario
˛˛^ i
==
˛˛j l
$str
˛˛m |
||
˛˛} 
tipousuario˛˛Ä ã
==˛˛å é
$str˛˛è û
||˛˛ü °
tipousuario˛˛¢ ≠
==˛˛Æ ∞
$str˛˛± ¿
)˛˛¿ ¡
{
ˇˇ 
reporte
ÄÄ 
.
ÄÄ 
Enabled
ÄÄ 
=
ÄÄ  !
true
ÄÄ" &
;
ÄÄ& '
}
ÅÅ 
else
ÇÇ 
if
ÇÇ 
(
ÇÇ 
tipousuario
ÇÇ  
==
ÇÇ! #
$str
ÇÇ$ 0
||
ÇÇ1 3
tipousuario
ÇÇ4 ?
==
ÇÇ@ B
$str
ÇÇC O
||
ÇÇP R
tipousuario
ÇÇS ^
==
ÇÇ_ a
$str
ÇÇb n
)
ÇÇn o
{
ÉÉ 
reporte
ÑÑ 
.
ÑÑ 
Enabled
ÑÑ 
=
ÑÑ  !
true
ÑÑ" &
;
ÑÑ& '
}
ÖÖ 
else
ÜÜ 
if
ÜÜ 
(
ÜÜ 
tipousuario
ÜÜ  
==
ÜÜ! #
$str
ÜÜ$ /
||
ÜÜ0 2
tipousuario
ÜÜ3 >
==
ÜÜ? A
$str
ÜÜB M
||
ÜÜN P
tipousuario
ÜÜQ \
==
ÜÜ] _
$str
ÜÜ` k
)
ÜÜk l
{
áá 
reporte
àà 
.
àà 
Enabled
àà 
=
àà  !
false
àà" '
;
àà' (
}
ââ 
}
ää 	
}
ãã 
}åå 